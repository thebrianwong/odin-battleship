(()=>{"use strict";const e=(()=>{const e=e=>{const s=["A","B","C","D","E","F","G","H","I","J"],i=["1","2","3","4","5","6","7","8","9","10"],d=a.getPlayers()[0];for(let n=-1;n<10;n++)for(let l=-1;l<10;l++)if(-1===n)if(-1===l){const t=document.createElement("div");t.classList.add("gameboard-label"),t.style.visibility="hidden",e.appendChild(t)}else{const t=document.createElement("div");t.classList.add("column-label"),t.textContent=s[l],e.appendChild(t)}else if(-1===l){const t=document.createElement("div");t.classList.add("row-label"),t.textContent=i[n],e.appendChild(t)}else if(Array.from(e.classList).includes("player-board")){const a=document.createElement("div");a.setAttribute("data-row",n),a.setAttribute("data-column",l),a.classList.add("gameboard-cell"),a.addEventListener("dragover",(e=>{r(e)})),a.addEventListener("drop",(e=>{o(e),5===d.getGameboard().getPlacedShips().length&&t("enable")})),e.appendChild(a)}else if(Array.from(e.classList).includes("computer-board")){const t=document.createElement("button");t.setAttribute("data-row",n),t.setAttribute("data-column",l),t.classList.add("gameboard-cell"),t.disabled=!0,t.addEventListener("click",(()=>{if(!a.isMidAttack()){const e=Number(t.dataset.row),a=Number(t.dataset.column);d.sendAttack([e,a])}})),e.appendChild(t)}},t=e=>{const t=document.querySelector(".computer-board"),a=Array.from(t.querySelectorAll(".gameboard-cell"));"enable"===e?a.forEach((e=>{e.disabled=!1})):"disable"===e&&a.forEach((e=>{e.disabled=!0}))},r=e=>{e.preventDefault()},s=()=>{const e=document.createElement("p");e.textContent="That is an invalid position.",e.classList.add("error-message"),document.body.appendChild(e),setTimeout((()=>{document.body.removeChild(e)}),2500)},o=e=>{e.preventDefault();const t=a.getPlayers()[0],r=e.target;if(Array.from(r.classList).includes("contains-ship-image"))return void s();const i=e.dataTransfer.getData("image"),d=JSON.parse(i);if(!((e,t)=>{const r=[Number(e.dataset.row),Number(e.dataset.column)],s=Number(t.shipLength);return t.horizontal?!!a.getPlayers()[0].checkIfValidEmptyCoordinates(r,s,"right"):t.vertical?!!a.getPlayers()[0].checkIfValidEmptyCoordinates(r,s,"down"):void 0})(r,d))return void s();const n=((e,t)=>{const a=t.shipLength,r=Number(e.dataset.row),s=Number(e.dataset.column),o=[[r,s]];e.classList.add("contains-ship-image"),e.classList.add("ship-image"),e.classList.add(`ship-image-${a}`),e.classList.add(`ship-image-${a}-1`),t.horizontal?e.classList.add("horizontal"):t.vertical&&e.classList.add("vertical");for(let e=1;e<a;e++){let i;t.horizontal?(i=document.querySelector(`.player-board [data-row='${r}'][data-column='${s+e}']`),i.classList.add("horizontal"),o.push([r,s+e])):t.vertical&&(i=document.querySelector(`.player-board [data-row='${r+e}'][data-column='${s}']`),i.classList.add("vertical"),o.push([r+e,s])),i.classList.add("contains-ship-image"),i.classList.add("ship-image"),i.classList.add(`ship-image-${a}`),i.classList.add(`ship-image-${a}-${e+1}`)}return o})(r,d);t.addShipToGameboard(Number(d.shipLength),n),(e=>{const t=e.elementID,a=document.querySelector(`#${t}`),r=a.parentNode.querySelector("button");a.setAttribute("draggable",!1),a.classList.add("disabled-image"),r.disabled=!0})(d),r.removeEventListener("drop",o)};return{initializeBoardDOM:()=>{const t=document.querySelector(".player-board"),a=document.querySelector(".computer-board");e(t),e(a)},insertDraggedImage:o,rotateShipImage:e=>{const t=Array.from(e.classList);t.includes("horizontal")?(e.classList.remove("horizontal"),e.classList.add("vertical")):t.includes("vertical")&&(e.classList.remove("vertical"),e.classList.add("horizontal"))},rotateDraggedImage:e=>{const t=e.target.cloneNode(),a=document.createElement("div");a.classList.add("temp-rotate"),((e,t)=>{const a=Array.from(t.classList);a.includes("horizontal")?e.classList.add("temp-rotate-horizontal"):a.includes("vertical")&&(e.classList.add("temp-rotate-vertical"),"5"===t.dataset.shipLength?e.classList.add("temp-rotate-vertical-5"):"4"===t.dataset.shipLength?e.classList.add("temp-rotate-vertical-4"):"3"===t.dataset.shipLength?e.classList.add("temp-rotate-vertical-3"):"2"===t.dataset.shipLength&&e.classList.add("temp-rotate-vertical-2"))})(a,t),a.appendChild(t),document.body.appendChild(a),e.dataTransfer.setDragImage(a,0,0),setTimeout((()=>{document.body.removeChild(a)}),0)},getDraggedImage:e=>{const t={image:e.target.src,shipLength:e.target.dataset.shipLength,horizontal:!1,vertical:!1,elementID:e.target.getAttribute("id")};Array.from(e.target.classList).includes("horizontal")?t.horizontal=!0:Array.from(e.target.classList).includes("vertical")&&(t.vertical=!0);const a=JSON.stringify(t);e.dataTransfer.setData("image",a)},dragOver:r,addAttackResultDOM:(e,t,a)=>{const r=a[0],s=a[1],o=document.querySelector(`.${e}-board`).querySelector(`[data-row='${r}'][data-column='${s}']`),i=document.createElement("img");i.classList.add("attack-results"),o.appendChild(i),"hit"===t?i.setAttribute("src","../dist/red_X.png"):i.setAttribute("src","../dist/white_O.png"),o.disabled=!0},toggleAbilityToAttack:t,displayWinner:e=>{const t=e.isComputer();document.querySelector(".game-results").classList.remove("default-hidden");document.querySelector(".display-winner").textContent=t?"Oh no, you lost! Try again!":"Congratulations, you won!"},resetDOM:()=>{document.querySelector(".player-board").innerHTML="",document.querySelector(".computer-board").innerHTML="",Array.from(document.querySelectorAll(".ship-piece")).forEach((e=>{e.setAttribute("draggable",!0),e.classList.remove("disabled-image"),Array.from(e.classList).includes("vertical")&&(e.classList.remove("vertical"),e.classList.add("horizontal"))})),Array.from(document.querySelectorAll(".rotate-ship")).forEach((e=>{e.disabled=!1})),(()=>{const e=document.querySelector(".game-results");e.classList.add("default-hidden"),e.querySelector(".display-winner").textContent="Placeholder"})()}}})(),t=t=>{const r="human"!==t&&("computer"===t||void 0),s=(()=>{const e=(()=>{const e=[];for(let t=0;t<10;t++){e.push([]);for(let a=0;a<10;a++)e[t].push(void 0)}return e})(),t=[],a=[],r=[],s=[],o=[];let i=!1;const d=t=>e[t[0]][t[1]];return{getCoordinates:d,getPlacedShips:()=>t,getReceivedMissedShots:()=>a,getReceivedHitShots:()=>r,getSentMissedShots:()=>s,getSentHitShots:()=>o,isAllShipsSunk:()=>i,placeShip:(a,r)=>{for(const t of r)e[t[0]][t[1]]=a;t.push(a)},receiveAttack:e=>{const s=d(e);return void 0!==s?(s.hit(),t.every((e=>e.isSunk()))&&(i=!0),r.push(e),"hit"):(a.push(e),"miss")},addSentMissedShot:e=>{s.push(e)},addSentHitShot:e=>{o.push(e)}}})();let o;const i=()=>r,d=(e,t)=>{const a=(e=>{const t=e;let a=0,r=!1;return{getShipLength:()=>t,getShipHits:()=>a,isSunk:()=>r,hit:()=>{if(r)return"That ship has already been sunk!";a+=1,a===t&&(r=!0)}}})(e);s.placeShip(a,t)},n=t=>{if(h(t)||!a.isInProgress()||a.isMidAttack())return;const r=o.getGameboard(),d=o.receiveAttack(t);if("hit"===d){if(s.addSentHitShot(t),i()?i()&&e.addAttackResultDOM("player",d,t):e.addAttackResultDOM("computer",d,t),r.isAllShipsSunk())return void a.endGame(o)}else"miss"===d&&(s.addSentMissedShot(t),i()?i()&&e.addAttackResultDOM("player",d,t):e.addAttackResultDOM("computer",d,t));if(o.isComputer()){a.toggleMidAttack(!0);const e=1e3*(Math.floor(4*Math.random())+1);setTimeout((()=>{a.toggleMidAttack(!1),o.sendComputerAttack()}),e)}},l=e=>{let t=[];do{t=[];const a=c(),r=u(a,e);t.push(a),t=t.concat(r)}while(t.length<e);return t},c=()=>{const e=[void 0,void 0];do{e[0]=m(),e[1]=m()}while(void 0!==s.getCoordinates(e));return e},u=(e,t)=>{const a=[];if(p(e,t,"up")){const r=[];for(let a=1;a<t;a++)r.push([e[0]-a,e[1]]);a.push(r)}if(p(e,t,"right")){const r=[];for(let a=1;a<t;a++)r.push([e[0],e[1]+a]);a.push(r)}if(p(e,t,"down")){const r=[];for(let a=1;a<t;a++)r.push([e[0]+a,e[1]]);a.push(r)}if(p(e,t,"left")){const r=[];for(let a=1;a<t;a++)r.push([e[0],e[1]-a]);a.push(r)}return 0===a.length?a:a[Math.floor(Math.random()*a.length)]},m=()=>Math.floor(10*Math.random()),h=e=>{let t=!1;const a=o.getGameboard().getReceivedMissedShots(),r=o.getGameboard().getReceivedHitShots();return t=a.some((t=>t[0]===e[0]&&t[1]===e[1])),t||(t=r.some((t=>t[0]===e[0]&&t[1]===e[1]))),t},p=(e,t,a)=>{switch(a){case"up":if(e[0]-(t-1)<0)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0]-a,e[1]]))return!1;return!0;case"right":if(e[1]+(t-1)>9)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0],e[1]+a]))return!1;return!0;case"down":if(e[0]+(t-1)>9)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0]+a,e[1]]))return!1;return!0;case"left":if(e[1]-(t-1)<0)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0],e[1]-a]))return!1;return!0}};return{isComputer:i,getGameboard:()=>s,getOpposingPlayer:()=>o,setOpposingPlayer:e=>{o=e},addShipToGameboard:d,sendAttack:n,initializeComputerGameboard:()=>{if(!r)return;const e=[5,4,3,3,2];for(const t of e){const e=l(t);d(t,e)}},sendComputerAttack:()=>{if(!r||!a.isInProgress())return;const e=(()=>{const e=[void 0,void 0];do{e[0]=m(),e[1]=m()}while(h(e));return e})();n(e)},receiveAttack:e=>s.receiveAttack(e),checkIfValidEmptyCoordinates:p}},a=(()=>{const a=[];let r,s=!0,o=!1;const i=()=>{const e=t("human");a.push(e);const r=t("computer");a.push(r),e.setOpposingPlayer(r),r.setOpposingPlayer(e),r.initializeComputerGameboard()},d=()=>{a.length=0,s=!0,r=void 0};return{getPlayers:()=>a,isInProgress:()=>s,getWinner:()=>r,isMidAttack:()=>o,toggleMidAttack:e=>{o=!!e},createGame:i,endGame:t=>{const a=t.getOpposingPlayer();s=!1,r=a,e.toggleAbilityToAttack("disable"),e.displayWinner(r)},resetGame:()=>{d(),e.resetDOM(),i(),e.initializeBoardDOM()},resetGameLoopState:d}})(),r=()=>{document.querySelectorAll(".ship-placement").forEach((t=>{const a=t.querySelector("img");t.querySelector("button").addEventListener("click",(()=>{e.rotateShipImage(a)}))}))},s=()=>{Array.from(document.querySelectorAll(".ship-piece")).forEach((t=>{t.addEventListener("dragstart",(t=>{e.getDraggedImage(t),e.rotateDraggedImage(t)}))}))},o=()=>{document.querySelector(".play-again").addEventListener("click",(()=>{a.resetGame()}))};a.createGame(),e.initializeBoardDOM(),r(),s(),o()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW5DdUJzQyxJQUNkTCxJQUFUSyxDQUFnRCxFQW1DaERKLGFBQ0FuQyxRQXpCZXdDLElBQ2YsTUFBTUMsRUFBZUQsRUFBWWYsb0JBQ2pDUSxHQUFhLEVBQ2JELEVBQVNTLEVBQ1R0TSxFQUFjaUMsc0JBQXNCLFdBQ3BDakMsRUFBYzhHLGNBQWMrRSxFQUFPLEVBcUJuQ1UsVUFkZ0IsS0FDaEJMLElBQ0FsTSxFQUFjaUgsV0FDZCtFLElBQ0FoTSxFQUFjc0Ysb0JBQW9CLEVBV2xDNEcscUJBRUgsRUFsRGdCLEdDQVhNLEVBQzZCLEtBQ0Q3TCxTQUFTcUMsaUJBQWlCLG1CQUNsQ0MsU0FBU3dKLElBQzdCLE1BQU14SCxFQUFld0gsRUFBZ0IzSixjQUFjLE9BQzdCMkosRUFBZ0IzSixjQUFjLFVBQ3RDcEIsaUJBQWlCLFNBQVMsS0FDdEMxQixFQUFjeUYsZ0JBQWdCUixFQUFhLEdBQzNDLEdBQ0YsRUFUQXVILEVBV3lCLEtBQ1JuTCxNQUFNQyxLQUFLWCxTQUFTcUMsaUJBQWlCLGdCQUM3Q0MsU0FBU3dGLElBQ2xCQSxFQUFLL0csaUJBQWlCLGFBQWNDLElBQ2xDM0IsRUFBY29HLGdCQUFnQnpFLEdBQzlCM0IsRUFBYzZGLG1CQUFtQmxFLEVBQU0sR0FDdkMsR0FDRixFQWxCQTZLLEVBb0J5QixLQUNIN0wsU0FBU21DLGNBQWMsZUFDL0JwQixpQkFBaUIsU0FBUyxLQUN4Q3BCLEVBQVNpTSxXQUFXLEdBQ3BCLEVDdkJOak0sRUFBUzBMLGFBRVRoTSxFQUFjc0YscUJBRWRrSCxJQUVBQSxJQUVBQSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL3NoaXAuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL0RPTV9jb250cm9sbGVyLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9wbGF5ZXIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL2dhbWVib2FyZC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZ2FtZWxvb3AuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL2V2ZW50X2xpc3RlbmVyX2NvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL2luZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFNoaXAgPSAoZ2l2ZW5MZW5ndGgpID0+IHtcbiAgY29uc3QgbGVuZ3RoID0gZ2l2ZW5MZW5ndGg7XG4gIGxldCBoaXRzID0gMDtcbiAgbGV0IHN1bmsgPSBmYWxzZTtcbiAgY29uc3QgZ2V0U2hpcExlbmd0aCA9ICgpID0+IGxlbmd0aDtcbiAgY29uc3QgZ2V0U2hpcEhpdHMgPSAoKSA9PiBoaXRzO1xuICBjb25zdCBpc1N1bmsgPSAoKSA9PiBzdW5rO1xuICBjb25zdCBjaGVja0lmU3VuayA9ICgpID0+IHtcbiAgICBpZiAoaGl0cyA9PT0gbGVuZ3RoKSB7XG4gICAgICBzdW5rID0gdHJ1ZTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGhpdCA9ICgpID0+IHtcbiAgICBpZiAoIXN1bmspIHtcbiAgICAgIGhpdHMgKz0gMTtcbiAgICAgIGNoZWNrSWZTdW5rKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBcIlRoYXQgc2hpcCBoYXMgYWxyZWFkeSBiZWVuIHN1bmshXCI7XG4gICAgfVxuICB9O1xuICByZXR1cm4ge1xuICAgIGdldFNoaXBMZW5ndGgsXG4gICAgZ2V0U2hpcEhpdHMsXG4gICAgaXNTdW5rLFxuICAgIGhpdCxcbiAgfTtcbn07XG5cbmV4cG9ydCB7IFNoaXAgfTtcbiIsImltcG9ydCB7IEdhbWVMb29wIH0gZnJvbSBcIi4vZ2FtZWxvb3BcIjtcblxuY29uc3QgRE9NQ29udHJvbGxlciA9ICgoKSA9PiB7XG4gIGNvbnN0IGNyZWF0ZUJvYXJkQ2VsbHMgPSAoZ2FtZWJvYXJkRE9NKSA9PiB7XG4gICAgY29uc3QgQk9BUkRBWEVTTEVOR1RIID0gMTA7XG4gICAgY29uc3QgY29sdW1uTGFiZWxzID0gW1wiQVwiLCBcIkJcIiwgXCJDXCIsIFwiRFwiLCBcIkVcIiwgXCJGXCIsIFwiR1wiLCBcIkhcIiwgXCJJXCIsIFwiSlwiXTtcbiAgICBjb25zdCByb3dMYWJlbHMgPSBbXCIxXCIsIFwiMlwiLCBcIjNcIiwgXCI0XCIsIFwiNVwiLCBcIjZcIiwgXCI3XCIsIFwiOFwiLCBcIjlcIiwgXCIxMFwiXTtcbiAgICBjb25zdCBodW1hblBsYXllck9iamVjdCA9IEdhbWVMb29wLmdldFBsYXllcnMoKVswXTtcbiAgICBmb3IgKGxldCBpID0gLTE7IGkgPCBCT0FSREFYRVNMRU5HVEg7IGkrKykge1xuICAgICAgZm9yIChsZXQgaiA9IC0xOyBqIDwgQk9BUkRBWEVTTEVOR1RIOyBqKyspIHtcbiAgICAgICAgaWYgKGkgPT09IC0xKSB7XG4gICAgICAgICAgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgICBjb25zdCBpbnZpc2libGVQbGFjZWhvbGRlckVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgaW52aXNpYmxlUGxhY2Vob2xkZXJFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJnYW1lYm9hcmQtbGFiZWxcIik7XG4gICAgICAgICAgICBpbnZpc2libGVQbGFjZWhvbGRlckVsZW1lbnQuc3R5bGUudmlzaWJpbGl0eSA9IFwiaGlkZGVuXCI7XG4gICAgICAgICAgICBnYW1lYm9hcmRET00uYXBwZW5kQ2hpbGQoaW52aXNpYmxlUGxhY2Vob2xkZXJFbGVtZW50KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgY29sdW1uTGFiZWxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICAgIGNvbHVtbkxhYmVsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiY29sdW1uLWxhYmVsXCIpO1xuICAgICAgICAgICAgY29sdW1uTGFiZWxFbGVtZW50LnRleHRDb250ZW50ID0gY29sdW1uTGFiZWxzW2pdO1xuICAgICAgICAgICAgZ2FtZWJvYXJkRE9NLmFwcGVuZENoaWxkKGNvbHVtbkxhYmVsRWxlbWVudCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKGogPT09IC0xKSB7XG4gICAgICAgICAgY29uc3Qgcm93TGFiZWxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICByb3dMYWJlbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcInJvdy1sYWJlbFwiKTtcbiAgICAgICAgICByb3dMYWJlbEVsZW1lbnQudGV4dENvbnRlbnQgPSByb3dMYWJlbHNbaV07XG4gICAgICAgICAgZ2FtZWJvYXJkRE9NLmFwcGVuZENoaWxkKHJvd0xhYmVsRWxlbWVudCk7XG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgQXJyYXkuZnJvbShnYW1lYm9hcmRET00uY2xhc3NMaXN0KS5pbmNsdWRlcyhcInBsYXllci1ib2FyZFwiKVxuICAgICAgICApIHtcbiAgICAgICAgICBjb25zdCBwbGF5ZXJDZWxsRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgcGxheWVyQ2VsbEVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1yb3dcIiwgaSk7XG4gICAgICAgICAgcGxheWVyQ2VsbEVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1jb2x1bW5cIiwgaik7XG4gICAgICAgICAgcGxheWVyQ2VsbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImdhbWVib2FyZC1jZWxsXCIpO1xuICAgICAgICAgIHBsYXllckNlbGxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnb3ZlclwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGRyYWdPdmVyKGV2ZW50KTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICBwbGF5ZXJDZWxsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiZHJvcFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGluc2VydERyYWdnZWRJbWFnZShldmVudCk7XG4gICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgIGh1bWFuUGxheWVyT2JqZWN0LmdldEdhbWVib2FyZCgpLmdldFBsYWNlZFNoaXBzKCkubGVuZ3RoID09PSA1XG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgdG9nZ2xlQWJpbGl0eVRvQXR0YWNrKFwiZW5hYmxlXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdhbWVib2FyZERPTS5hcHBlbmRDaGlsZChwbGF5ZXJDZWxsRWxlbWVudCk7XG4gICAgICAgIH0gZWxzZSBpZiAoXG4gICAgICAgICAgQXJyYXkuZnJvbShnYW1lYm9hcmRET00uY2xhc3NMaXN0KS5pbmNsdWRlcyhcImNvbXB1dGVyLWJvYXJkXCIpXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnN0IGNvbXB1dGVyQ2VsbEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICAgIGNvbXB1dGVyQ2VsbEVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGF0YS1yb3dcIiwgaSk7XG4gICAgICAgICAgY29tcHV0ZXJDZWxsRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWNvbHVtblwiLCBqKTtcbiAgICAgICAgICBjb21wdXRlckNlbGxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJnYW1lYm9hcmQtY2VsbFwiKTtcbiAgICAgICAgICBjb21wdXRlckNlbGxFbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgICAgICBjb21wdXRlckNlbGxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgICAgICBpZiAoIUdhbWVMb29wLmlzTWlkQXR0YWNrKCkpIHtcbiAgICAgICAgICAgICAgY29uc3QgY2VsbFJvdyA9IE51bWJlcihjb21wdXRlckNlbGxFbGVtZW50LmRhdGFzZXQucm93KTtcbiAgICAgICAgICAgICAgY29uc3QgY2VsbENvbHVtbiA9IE51bWJlcihjb21wdXRlckNlbGxFbGVtZW50LmRhdGFzZXQuY29sdW1uKTtcbiAgICAgICAgICAgICAgaHVtYW5QbGF5ZXJPYmplY3Quc2VuZEF0dGFjayhbY2VsbFJvdywgY2VsbENvbHVtbl0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGdhbWVib2FyZERPTS5hcHBlbmRDaGlsZChjb21wdXRlckNlbGxFbGVtZW50KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgdG9nZ2xlQWJpbGl0eVRvQXR0YWNrID0gKGFjdGlvbikgPT4ge1xuICAgIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcHV0ZXItYm9hcmRcIik7XG4gICAgY29uc3QgY2VsbEVsZW1lbnRzID0gQXJyYXkuZnJvbShcbiAgICAgIGNvbXB1dGVyR2FtZWJvYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLmdhbWVib2FyZC1jZWxsXCIpXG4gICAgKTtcbiAgICBpZiAoYWN0aW9uID09PSBcImVuYWJsZVwiKSB7XG4gICAgICBjZWxsRWxlbWVudHMuZm9yRWFjaCgoY2VsbEVsZW1lbnQpID0+IHtcbiAgICAgICAgY2VsbEVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcbiAgICAgIH0pO1xuICAgIH0gZWxzZSBpZiAoYWN0aW9uID09PSBcImRpc2FibGVcIikge1xuICAgICAgY2VsbEVsZW1lbnRzLmZvckVhY2goKGNlbGxFbGVtZW50KSA9PiB7XG4gICAgICAgIGNlbGxFbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgZ2V0RHJhZ2dlZEltYWdlID0gKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgZGF0YU9iamVjdCA9IHtcbiAgICAgIGltYWdlOiBldmVudC50YXJnZXQuc3JjLFxuICAgICAgc2hpcExlbmd0aDogZXZlbnQudGFyZ2V0LmRhdGFzZXQuc2hpcExlbmd0aCxcbiAgICAgIGhvcml6b250YWw6IGZhbHNlLFxuICAgICAgdmVydGljYWw6IGZhbHNlLFxuICAgICAgZWxlbWVudElEOiBldmVudC50YXJnZXQuZ2V0QXR0cmlidXRlKFwiaWRcIiksXG4gICAgfTtcbiAgICBpZiAoQXJyYXkuZnJvbShldmVudC50YXJnZXQuY2xhc3NMaXN0KS5pbmNsdWRlcyhcImhvcml6b250YWxcIikpIHtcbiAgICAgIGRhdGFPYmplY3QuaG9yaXpvbnRhbCA9IHRydWU7XG4gICAgfSBlbHNlIGlmIChBcnJheS5mcm9tKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QpLmluY2x1ZGVzKFwidmVydGljYWxcIikpIHtcbiAgICAgIGRhdGFPYmplY3QudmVydGljYWwgPSB0cnVlO1xuICAgIH1cbiAgICBjb25zdCBkYXRhU3RyaW5nID0gSlNPTi5zdHJpbmdpZnkoZGF0YU9iamVjdCk7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyLnNldERhdGEoXCJpbWFnZVwiLCBkYXRhU3RyaW5nKTtcbiAgfTtcbiAgY29uc3QgZHJhZ092ZXIgPSAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICB9O1xuICBjb25zdCBpbml0aWFsaXplQm9hcmRET00gPSAoKSA9PiB7XG4gICAgY29uc3QgaHVtYW5QbGF5ZXJHYW1lYm9hcmRET00gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXllci1ib2FyZFwiKTtcbiAgICBjb25zdCBjb21wdXRlckdhbWVib2FyZERPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY29tcHV0ZXItYm9hcmRcIik7XG4gICAgY3JlYXRlQm9hcmRDZWxscyhodW1hblBsYXllckdhbWVib2FyZERPTSk7XG4gICAgY3JlYXRlQm9hcmRDZWxscyhjb21wdXRlckdhbWVib2FyZERPTSk7XG4gIH07XG4gIGNvbnN0IGlzVmFsaWRHYW1lYm9hcmRDZWxsID0gKHRhcmdldENlbGwsIGRhdGFPYmplY3QpID0+IHtcbiAgICBjb25zdCBjZWxsQ29vcmRpbmF0ZXMgPSBbXG4gICAgICBOdW1iZXIodGFyZ2V0Q2VsbC5kYXRhc2V0LnJvdyksXG4gICAgICBOdW1iZXIodGFyZ2V0Q2VsbC5kYXRhc2V0LmNvbHVtbiksXG4gICAgXTtcbiAgICBjb25zdCBsZW5ndGggPSBOdW1iZXIoZGF0YU9iamVjdC5zaGlwTGVuZ3RoKTtcbiAgICBpZiAoZGF0YU9iamVjdC5ob3Jpem9udGFsKSB7XG4gICAgICBpZiAoXG4gICAgICAgIEdhbWVMb29wLmdldFBsYXllcnMoKVswXS5jaGVja0lmVmFsaWRFbXB0eUNvb3JkaW5hdGVzKFxuICAgICAgICAgIGNlbGxDb29yZGluYXRlcyxcbiAgICAgICAgICBsZW5ndGgsXG4gICAgICAgICAgXCJyaWdodFwiXG4gICAgICAgIClcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKGRhdGFPYmplY3QudmVydGljYWwpIHtcbiAgICAgIGlmIChcbiAgICAgICAgR2FtZUxvb3AuZ2V0UGxheWVycygpWzBdLmNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMoXG4gICAgICAgICAgY2VsbENvb3JkaW5hdGVzLFxuICAgICAgICAgIGxlbmd0aCxcbiAgICAgICAgICBcImRvd25cIlxuICAgICAgICApXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xuICBjb25zdCBhZGRTaGlwVG9ET00gPSAodGFyZ2V0Q2VsbCwgZGF0YU9iamVjdCkgPT4ge1xuICAgIGNvbnN0IGxlbmd0aCA9IGRhdGFPYmplY3Quc2hpcExlbmd0aDtcbiAgICBjb25zdCB0YXJnZXRDZWxsUm93ID0gTnVtYmVyKHRhcmdldENlbGwuZGF0YXNldC5yb3cpO1xuICAgIGNvbnN0IHRhcmdldENlbGxDb2x1bW4gPSBOdW1iZXIodGFyZ2V0Q2VsbC5kYXRhc2V0LmNvbHVtbik7XG4gICAgY29uc3QgY29vcmRpbmF0ZXNBcnJheSA9IFtbdGFyZ2V0Q2VsbFJvdywgdGFyZ2V0Q2VsbENvbHVtbl1dO1xuICAgIHRhcmdldENlbGwuY2xhc3NMaXN0LmFkZChcImNvbnRhaW5zLXNoaXAtaW1hZ2VcIik7XG4gICAgdGFyZ2V0Q2VsbC5jbGFzc0xpc3QuYWRkKFwic2hpcC1pbWFnZVwiKTtcbiAgICB0YXJnZXRDZWxsLmNsYXNzTGlzdC5hZGQoYHNoaXAtaW1hZ2UtJHtsZW5ndGh9YCk7XG4gICAgdGFyZ2V0Q2VsbC5jbGFzc0xpc3QuYWRkKGBzaGlwLWltYWdlLSR7bGVuZ3RofS0xYCk7XG4gICAgaWYgKGRhdGFPYmplY3QuaG9yaXpvbnRhbCkge1xuICAgICAgdGFyZ2V0Q2VsbC5jbGFzc0xpc3QuYWRkKFwiaG9yaXpvbnRhbFwiKTtcbiAgICB9IGVsc2UgaWYgKGRhdGFPYmplY3QudmVydGljYWwpIHtcbiAgICAgIHRhcmdldENlbGwuY2xhc3NMaXN0LmFkZChcInZlcnRpY2FsXCIpO1xuICAgIH1cbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgcmVtYWluaW5nQ2VsbDtcbiAgICAgIGlmIChkYXRhT2JqZWN0Lmhvcml6b250YWwpIHtcbiAgICAgICAgcmVtYWluaW5nQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgYC5wbGF5ZXItYm9hcmQgW2RhdGEtcm93PScke3RhcmdldENlbGxSb3d9J11bZGF0YS1jb2x1bW49JyR7XG4gICAgICAgICAgICB0YXJnZXRDZWxsQ29sdW1uICsgaVxuICAgICAgICAgIH0nXWBcbiAgICAgICAgKTtcbiAgICAgICAgcmVtYWluaW5nQ2VsbC5jbGFzc0xpc3QuYWRkKFwiaG9yaXpvbnRhbFwiKTtcbiAgICAgICAgY29vcmRpbmF0ZXNBcnJheS5wdXNoKFt0YXJnZXRDZWxsUm93LCB0YXJnZXRDZWxsQ29sdW1uICsgaV0pO1xuICAgICAgfSBlbHNlIGlmIChkYXRhT2JqZWN0LnZlcnRpY2FsKSB7XG4gICAgICAgIHJlbWFpbmluZ0NlbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgICAgIGAucGxheWVyLWJvYXJkIFtkYXRhLXJvdz0nJHtcbiAgICAgICAgICAgIHRhcmdldENlbGxSb3cgKyBpXG4gICAgICAgICAgfSddW2RhdGEtY29sdW1uPScke3RhcmdldENlbGxDb2x1bW59J11gXG4gICAgICAgICk7XG4gICAgICAgIHJlbWFpbmluZ0NlbGwuY2xhc3NMaXN0LmFkZChcInZlcnRpY2FsXCIpO1xuICAgICAgICBjb29yZGluYXRlc0FycmF5LnB1c2goW3RhcmdldENlbGxSb3cgKyBpLCB0YXJnZXRDZWxsQ29sdW1uXSk7XG4gICAgICB9XG4gICAgICByZW1haW5pbmdDZWxsLmNsYXNzTGlzdC5hZGQoXCJjb250YWlucy1zaGlwLWltYWdlXCIpO1xuICAgICAgcmVtYWluaW5nQ2VsbC5jbGFzc0xpc3QuYWRkKFwic2hpcC1pbWFnZVwiKTtcbiAgICAgIHJlbWFpbmluZ0NlbGwuY2xhc3NMaXN0LmFkZChgc2hpcC1pbWFnZS0ke2xlbmd0aH1gKTtcbiAgICAgIHJlbWFpbmluZ0NlbGwuY2xhc3NMaXN0LmFkZChgc2hpcC1pbWFnZS0ke2xlbmd0aH0tJHtpICsgMX1gKTtcbiAgICB9XG4gICAgcmV0dXJuIGNvb3JkaW5hdGVzQXJyYXk7XG4gIH07XG4gIGNvbnN0IGRpc2FibGVJbWFnZUJ1dHRvbkludGVyYWN0aW9ucyA9IChkYXRhT2JqZWN0KSA9PiB7XG4gICAgY29uc3QgSUQgPSBkYXRhT2JqZWN0LmVsZW1lbnRJRDtcbiAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjJHtJRH1gKTtcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gaW1hZ2VFbGVtZW50LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKTtcbiAgICBpbWFnZUVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZHJhZ2dhYmxlXCIsIGZhbHNlKTtcbiAgICBpbWFnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImRpc2FibGVkLWltYWdlXCIpO1xuICAgIGJ1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICB9O1xuICBjb25zdCBjcmVhdGVFcnJvck1lc3NhZ2UgPSAoKSA9PiB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG4gICAgZXJyb3JNZXNzYWdlLnRleHRDb250ZW50ID0gXCJUaGF0IGlzIGFuIGludmFsaWQgcG9zaXRpb24uXCI7XG4gICAgZXJyb3JNZXNzYWdlLmNsYXNzTGlzdC5hZGQoXCJlcnJvci1tZXNzYWdlXCIpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoZXJyb3JNZXNzYWdlKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoZXJyb3JNZXNzYWdlKTtcbiAgICB9LCAyNTAwKTtcbiAgfTtcbiAgY29uc3QgaW5zZXJ0RHJhZ2dlZEltYWdlID0gKGV2ZW50KSA9PiB7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBjb25zdCBodW1hblBsYXllck9iamVjdCA9IEdhbWVMb29wLmdldFBsYXllcnMoKVswXTtcbiAgICBjb25zdCB0YXJnZXRDZWxsID0gZXZlbnQudGFyZ2V0O1xuICAgIGlmIChBcnJheS5mcm9tKHRhcmdldENlbGwuY2xhc3NMaXN0KS5pbmNsdWRlcyhcImNvbnRhaW5zLXNoaXAtaW1hZ2VcIikpIHtcbiAgICAgIGNyZWF0ZUVycm9yTWVzc2FnZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBkYXRhU3RyaW5nID0gZXZlbnQuZGF0YVRyYW5zZmVyLmdldERhdGEoXCJpbWFnZVwiKTtcbiAgICBjb25zdCBkYXRhT2JqZWN0ID0gSlNPTi5wYXJzZShkYXRhU3RyaW5nKTtcbiAgICBpZiAoIWlzVmFsaWRHYW1lYm9hcmRDZWxsKHRhcmdldENlbGwsIGRhdGFPYmplY3QpKSB7XG4gICAgICBjcmVhdGVFcnJvck1lc3NhZ2UoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgc2hpcENvb3JkaW5hdGVzID0gYWRkU2hpcFRvRE9NKHRhcmdldENlbGwsIGRhdGFPYmplY3QpO1xuICAgIGh1bWFuUGxheWVyT2JqZWN0LmFkZFNoaXBUb0dhbWVib2FyZChcbiAgICAgIE51bWJlcihkYXRhT2JqZWN0LnNoaXBMZW5ndGgpLFxuICAgICAgc2hpcENvb3JkaW5hdGVzXG4gICAgKTtcbiAgICBkaXNhYmxlSW1hZ2VCdXR0b25JbnRlcmFjdGlvbnMoZGF0YU9iamVjdCk7XG4gICAgdGFyZ2V0Q2VsbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZHJvcFwiLCBpbnNlcnREcmFnZ2VkSW1hZ2UpO1xuICB9O1xuICBjb25zdCByb3RhdGVTaGlwSW1hZ2UgPSAoaW1hZ2UpID0+IHtcbiAgICBjb25zdCBpbWFnZUNsYXNzZXMgPSBBcnJheS5mcm9tKGltYWdlLmNsYXNzTGlzdCk7XG4gICAgaWYgKGltYWdlQ2xhc3Nlcy5pbmNsdWRlcyhcImhvcml6b250YWxcIikpIHtcbiAgICAgIGltYWdlLmNsYXNzTGlzdC5yZW1vdmUoXCJob3Jpem9udGFsXCIpO1xuICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZChcInZlcnRpY2FsXCIpO1xuICAgIH0gZWxzZSBpZiAoaW1hZ2VDbGFzc2VzLmluY2x1ZGVzKFwidmVydGljYWxcIikpIHtcbiAgICAgIGltYWdlLmNsYXNzTGlzdC5yZW1vdmUoXCJ2ZXJ0aWNhbFwiKTtcbiAgICAgIGltYWdlLmNsYXNzTGlzdC5hZGQoXCJob3Jpem9udGFsXCIpO1xuICAgIH1cbiAgfTtcbiAgY29uc3Qgcm90YXRlUGVyTGVuZ3RoID0gKHRlbXBEaXYsIGNsb25lZEltYWdlRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IGNsb25lZEltYWdlRWxlbWVudENsYXNzZXMgPSBBcnJheS5mcm9tKGNsb25lZEltYWdlRWxlbWVudC5jbGFzc0xpc3QpO1xuICAgIGlmIChjbG9uZWRJbWFnZUVsZW1lbnRDbGFzc2VzLmluY2x1ZGVzKFwiaG9yaXpvbnRhbFwiKSkge1xuICAgICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGUtaG9yaXpvbnRhbFwiKTtcbiAgICB9IGVsc2UgaWYgKGNsb25lZEltYWdlRWxlbWVudENsYXNzZXMuaW5jbHVkZXMoXCJ2ZXJ0aWNhbFwiKSkge1xuICAgICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGUtdmVydGljYWxcIik7XG4gICAgICBpZiAoY2xvbmVkSW1hZ2VFbGVtZW50LmRhdGFzZXQuc2hpcExlbmd0aCA9PT0gXCI1XCIpIHtcbiAgICAgICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGUtdmVydGljYWwtNVwiKTtcbiAgICAgIH0gZWxzZSBpZiAoY2xvbmVkSW1hZ2VFbGVtZW50LmRhdGFzZXQuc2hpcExlbmd0aCA9PT0gXCI0XCIpIHtcbiAgICAgICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGUtdmVydGljYWwtNFwiKTtcbiAgICAgIH0gZWxzZSBpZiAoY2xvbmVkSW1hZ2VFbGVtZW50LmRhdGFzZXQuc2hpcExlbmd0aCA9PT0gXCIzXCIpIHtcbiAgICAgICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGUtdmVydGljYWwtM1wiKTtcbiAgICAgIH0gZWxzZSBpZiAoY2xvbmVkSW1hZ2VFbGVtZW50LmRhdGFzZXQuc2hpcExlbmd0aCA9PT0gXCIyXCIpIHtcbiAgICAgICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGUtdmVydGljYWwtMlwiKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG4gIGNvbnN0IHJvdGF0ZURyYWdnZWRJbWFnZSA9IChldmVudCkgPT4ge1xuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IGV2ZW50LnRhcmdldDtcbiAgICBjb25zdCBjbG9uZWRJbWFnZUVsZW1lbnQgPSBpbWFnZUVsZW1lbnQuY2xvbmVOb2RlKCk7XG4gICAgY29uc3QgdGVtcERpdiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgdGVtcERpdi5jbGFzc0xpc3QuYWRkKFwidGVtcC1yb3RhdGVcIik7XG4gICAgcm90YXRlUGVyTGVuZ3RoKHRlbXBEaXYsIGNsb25lZEltYWdlRWxlbWVudCk7XG4gICAgdGVtcERpdi5hcHBlbmRDaGlsZChjbG9uZWRJbWFnZUVsZW1lbnQpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodGVtcERpdik7XG4gICAgZXZlbnQuZGF0YVRyYW5zZmVyLnNldERyYWdJbWFnZSh0ZW1wRGl2LCAwLCAwKTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQodGVtcERpdik7XG4gICAgfSwgMCk7XG4gIH07XG4gIGNvbnN0IGFkZEF0dGFja1Jlc3VsdERPTSA9IChwbGF5ZXJUeXBlLCBhdHRhY2tSZXN1bHRzLCBjb29yZGluYXRlcykgPT4ge1xuICAgIGNvbnN0IGNlbGxSb3cgPSBjb29yZGluYXRlc1swXTtcbiAgICBjb25zdCBjZWxsQ29sdW1uID0gY29vcmRpbmF0ZXNbMV07XG4gICAgY29uc3QgZ2FtZWJvYXJkRE9NID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLiR7cGxheWVyVHlwZX0tYm9hcmRgKTtcbiAgICBjb25zdCB0YXJnZXRDZWxsID0gZ2FtZWJvYXJkRE9NLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBgW2RhdGEtcm93PScke2NlbGxSb3d9J11bZGF0YS1jb2x1bW49JyR7Y2VsbENvbHVtbn0nXWBcbiAgICApO1xuICAgIGNvbnN0IGF0dGFja1Jlc3VsdHNFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKTtcbiAgICBhdHRhY2tSZXN1bHRzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiYXR0YWNrLXJlc3VsdHNcIik7XG4gICAgdGFyZ2V0Q2VsbC5hcHBlbmRDaGlsZChhdHRhY2tSZXN1bHRzRWxlbWVudCk7XG4gICAgaWYgKGF0dGFja1Jlc3VsdHMgPT09IFwiaGl0XCIpIHtcbiAgICAgIGF0dGFja1Jlc3VsdHNFbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBcIi4uL2Rpc3QvcmVkX1gucG5nXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhdHRhY2tSZXN1bHRzRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgXCIuLi9kaXN0L3doaXRlX08ucG5nXCIpO1xuICAgIH1cbiAgICB0YXJnZXRDZWxsLmRpc2FibGVkID0gdHJ1ZTtcbiAgfTtcbiAgY29uc3QgZGlzcGxheVdpbm5lciA9ICh3aW5uaW5nUGxheWVyKSA9PiB7XG4gICAgY29uc3QgcGxheWVyVHlwZSA9IHdpbm5pbmdQbGF5ZXIuaXNDb21wdXRlcigpO1xuICAgIGNvbnN0IGdhbWVSZXN1bHRzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FtZS1yZXN1bHRzXCIpO1xuICAgIGdhbWVSZXN1bHRzRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwiZGVmYXVsdC1oaWRkZW5cIik7XG4gICAgY29uc3QgZGlzcGxheVdpbm5lckVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmRpc3BsYXktd2lubmVyXCIpO1xuICAgIGlmICghcGxheWVyVHlwZSkge1xuICAgICAgZGlzcGxheVdpbm5lckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIkNvbmdyYXR1bGF0aW9ucywgeW91IHdvbiFcIjtcbiAgICB9IGVsc2Uge1xuICAgICAgZGlzcGxheVdpbm5lckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIk9oIG5vLCB5b3UgbG9zdCEgVHJ5IGFnYWluIVwiO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgcmVzZXRHYW1lYm9hcmRzID0gKCkgPT4ge1xuICAgIGNvbnN0IHBsYXllckdhbWVib2FyZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLWJvYXJkXCIpO1xuICAgIHBsYXllckdhbWVib2FyZC5pbm5lckhUTUwgPSBcIlwiO1xuICAgIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wdXRlci1ib2FyZFwiKTtcbiAgICBjb21wdXRlckdhbWVib2FyZC5pbm5lckhUTUwgPSBcIlwiO1xuICB9O1xuICBjb25zdCByZXNldFNoaXBJbWFnZXMgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2hpcFBpZWNlSW1hZ2VzID0gQXJyYXkuZnJvbShcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2hpcC1waWVjZVwiKVxuICAgICk7XG4gICAgc2hpcFBpZWNlSW1hZ2VzLmZvckVhY2goKGltYWdlKSA9PiB7XG4gICAgICBpbWFnZS5zZXRBdHRyaWJ1dGUoXCJkcmFnZ2FibGVcIiwgdHJ1ZSk7XG4gICAgICBpbWFnZS5jbGFzc0xpc3QucmVtb3ZlKFwiZGlzYWJsZWQtaW1hZ2VcIik7XG4gICAgICBpZiAoQXJyYXkuZnJvbShpbWFnZS5jbGFzc0xpc3QpLmluY2x1ZGVzKFwidmVydGljYWxcIikpIHtcbiAgICAgICAgaW1hZ2UuY2xhc3NMaXN0LnJlbW92ZShcInZlcnRpY2FsXCIpO1xuICAgICAgICBpbWFnZS5jbGFzc0xpc3QuYWRkKFwiaG9yaXpvbnRhbFwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcbiAgY29uc3QgcmVzZXRSb3RhdGVTaGlwQnV0dG9ucyA9ICgpID0+IHtcbiAgICBjb25zdCByb3RhdGVTaGlwQnV0dG9ucyA9IEFycmF5LmZyb20oXG4gICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnJvdGF0ZS1zaGlwXCIpXG4gICAgKTtcbiAgICByb3RhdGVTaGlwQnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IHtcbiAgICAgIGJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICAgIH0pO1xuICB9O1xuICBjb25zdCByZXNldEdhbWVSZXN1bHRzID0gKCkgPT4ge1xuICAgIGNvbnN0IGdhbWVSZXN1bHRzRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FtZS1yZXN1bHRzXCIpO1xuICAgIGdhbWVSZXN1bHRzRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZGVmYXVsdC1oaWRkZW5cIik7XG4gICAgY29uc3QgZGlzcGxheVdpbm5lckVsZW1lbnQgPVxuICAgICAgZ2FtZVJlc3VsdHNFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlzcGxheS13aW5uZXJcIik7XG4gICAgZGlzcGxheVdpbm5lckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlBsYWNlaG9sZGVyXCI7XG4gIH07XG4gIGNvbnN0IHJlc2V0RE9NID0gKCkgPT4ge1xuICAgIHJlc2V0R2FtZWJvYXJkcygpO1xuICAgIHJlc2V0U2hpcEltYWdlcygpO1xuICAgIHJlc2V0Um90YXRlU2hpcEJ1dHRvbnMoKTtcbiAgICByZXNldEdhbWVSZXN1bHRzKCk7XG4gIH07XG4gIHJldHVybiB7XG4gICAgaW5pdGlhbGl6ZUJvYXJkRE9NLFxuICAgIGluc2VydERyYWdnZWRJbWFnZSxcbiAgICByb3RhdGVTaGlwSW1hZ2UsXG4gICAgcm90YXRlRHJhZ2dlZEltYWdlLFxuICAgIGdldERyYWdnZWRJbWFnZSxcbiAgICBkcmFnT3ZlcixcbiAgICBhZGRBdHRhY2tSZXN1bHRET00sXG4gICAgdG9nZ2xlQWJpbGl0eVRvQXR0YWNrLFxuICAgIGRpc3BsYXlXaW5uZXIsXG4gICAgcmVzZXRET00sXG4gIH07XG59KSgpO1xuXG5leHBvcnQgeyBET01Db250cm9sbGVyIH07XG4iLCJpbXBvcnQgeyBTaGlwIH0gZnJvbSBcIi4vc2hpcFwiO1xuaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSBcIi4vZ2FtZWJvYXJkXCI7XG5pbXBvcnQgeyBHYW1lTG9vcCB9IGZyb20gXCIuL2dhbWVsb29wXCI7XG5pbXBvcnQgeyBET01Db250cm9sbGVyIH0gZnJvbSBcIi4vRE9NX2NvbnRyb2xsZXJcIjtcblxuY29uc3QgUGxheWVyID0gKHBsYXllclR5cGUpID0+IHtcbiAgY29uc3QgZGV0ZXJtaW5lUGxheWVyVHlwZSA9ICgpID0+IHtcbiAgICBpZiAocGxheWVyVHlwZSA9PT0gXCJodW1hblwiKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmIChwbGF5ZXJUeXBlID09PSBcImNvbXB1dGVyXCIpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgY29tcHV0ZXJQbGF5ZXIgPSBkZXRlcm1pbmVQbGF5ZXJUeXBlKCk7XG4gIGNvbnN0IHBsYXllckdhbWVib2FyZCA9IEdhbWVib2FyZCgpO1xuICBsZXQgb3Bwb3NpbmdQbGF5ZXI7XG4gIGNvbnN0IGlzQ29tcHV0ZXIgPSAoKSA9PiBjb21wdXRlclBsYXllcjtcbiAgY29uc3QgZ2V0R2FtZWJvYXJkID0gKCkgPT4gcGxheWVyR2FtZWJvYXJkO1xuICBjb25zdCBnZXRPcHBvc2luZ1BsYXllciA9ICgpID0+IG9wcG9zaW5nUGxheWVyO1xuICBjb25zdCBzZXRPcHBvc2luZ1BsYXllciA9IChwbGF5ZXIpID0+IHtcbiAgICBvcHBvc2luZ1BsYXllciA9IHBsYXllcjtcbiAgfTtcbiAgY29uc3QgYWRkU2hpcFRvR2FtZWJvYXJkID0gKHNoaXBMZW5ndGgsIGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgY29uc3Qgc2hpcCA9IFNoaXAoc2hpcExlbmd0aCk7XG4gICAgcGxheWVyR2FtZWJvYXJkLnBsYWNlU2hpcChzaGlwLCBjb29yZGluYXRlcyk7XG4gIH07XG4gIGNvbnN0IHNlbmRBdHRhY2sgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBpZiAoXG4gICAgICBjaGVja0lmUHJldmlvdXNseUF0dGFja2VkKGNvb3JkaW5hdGVzKSB8fFxuICAgICAgIUdhbWVMb29wLmlzSW5Qcm9ncmVzcygpIHx8XG4gICAgICBHYW1lTG9vcC5pc01pZEF0dGFjaygpXG4gICAgKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IG9wcG9zaW5nUGxheWVyR2FtZWJvYXJkID0gb3Bwb3NpbmdQbGF5ZXIuZ2V0R2FtZWJvYXJkKCk7XG4gICAgY29uc3QgYXR0YWNrUmVzdWx0cyA9IG9wcG9zaW5nUGxheWVyLnJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMpO1xuICAgIGlmIChhdHRhY2tSZXN1bHRzID09PSBcImhpdFwiKSB7XG4gICAgICBwbGF5ZXJHYW1lYm9hcmQuYWRkU2VudEhpdFNob3QoY29vcmRpbmF0ZXMpO1xuICAgICAgaWYgKCFpc0NvbXB1dGVyKCkpIHtcbiAgICAgICAgRE9NQ29udHJvbGxlci5hZGRBdHRhY2tSZXN1bHRET00oXG4gICAgICAgICAgXCJjb21wdXRlclwiLFxuICAgICAgICAgIGF0dGFja1Jlc3VsdHMsXG4gICAgICAgICAgY29vcmRpbmF0ZXNcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNDb21wdXRlcigpKSB7XG4gICAgICAgIERPTUNvbnRyb2xsZXIuYWRkQXR0YWNrUmVzdWx0RE9NKFwicGxheWVyXCIsIGF0dGFja1Jlc3VsdHMsIGNvb3JkaW5hdGVzKTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHBvc2luZ1BsYXllckdhbWVib2FyZC5pc0FsbFNoaXBzU3VuaygpKSB7XG4gICAgICAgIEdhbWVMb29wLmVuZEdhbWUob3Bwb3NpbmdQbGF5ZXIpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChhdHRhY2tSZXN1bHRzID09PSBcIm1pc3NcIikge1xuICAgICAgcGxheWVyR2FtZWJvYXJkLmFkZFNlbnRNaXNzZWRTaG90KGNvb3JkaW5hdGVzKTtcbiAgICAgIGlmICghaXNDb21wdXRlcigpKSB7XG4gICAgICAgIERPTUNvbnRyb2xsZXIuYWRkQXR0YWNrUmVzdWx0RE9NKFxuICAgICAgICAgIFwiY29tcHV0ZXJcIixcbiAgICAgICAgICBhdHRhY2tSZXN1bHRzLFxuICAgICAgICAgIGNvb3JkaW5hdGVzXG4gICAgICAgICk7XG4gICAgICB9IGVsc2UgaWYgKGlzQ29tcHV0ZXIoKSkge1xuICAgICAgICBET01Db250cm9sbGVyLmFkZEF0dGFja1Jlc3VsdERPTShcInBsYXllclwiLCBhdHRhY2tSZXN1bHRzLCBjb29yZGluYXRlcyk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChvcHBvc2luZ1BsYXllci5pc0NvbXB1dGVyKCkpIHtcbiAgICAgIEdhbWVMb29wLnRvZ2dsZU1pZEF0dGFjayh0cnVlKTtcbiAgICAgIGNvbnN0IHJhbmRvbURlbGF5ID0gKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpICsgMSkgKiAxMDAwO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIEdhbWVMb29wLnRvZ2dsZU1pZEF0dGFjayhmYWxzZSk7XG4gICAgICAgIG9wcG9zaW5nUGxheWVyLnNlbmRDb21wdXRlckF0dGFjaygpO1xuICAgICAgfSwgcmFuZG9tRGVsYXkpO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgaW5pdGlhbGl6ZUNvbXB1dGVyR2FtZWJvYXJkID0gKCkgPT4ge1xuICAgIGlmICghY29tcHV0ZXJQbGF5ZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbGVuZ3Roc09mU2hpcHMgPSBbNSwgNCwgMywgMywgMl07XG4gICAgZm9yIChjb25zdCBzaGlwTGVuZ3RoIG9mIGxlbmd0aHNPZlNoaXBzKSB7XG4gICAgICBjb25zdCBzaGlwQ29vcmRpbmF0ZXMgPSBnZW5lcmF0ZUNvbXB1dGVyU2hpcENvb3JkaW5hdGVzKHNoaXBMZW5ndGgpO1xuICAgICAgYWRkU2hpcFRvR2FtZWJvYXJkKHNoaXBMZW5ndGgsIHNoaXBDb29yZGluYXRlcyk7XG4gICAgfVxuICB9O1xuICBjb25zdCBzZW5kQ29tcHV0ZXJBdHRhY2sgPSAoKSA9PiB7XG4gICAgaWYgKCFjb21wdXRlclBsYXllciB8fCAhR2FtZUxvb3AuaXNJblByb2dyZXNzKCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgYXR0YWNrQ29vcmRpbmF0ZXMgPSBnZW5lcmF0ZUF0dGFja0Nvb3JkaW5hdGVzKCk7XG4gICAgc2VuZEF0dGFjayhhdHRhY2tDb29yZGluYXRlcyk7XG4gIH07XG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBjb25zdCBhdHRhY2tSZXN1bHRzID0gcGxheWVyR2FtZWJvYXJkLnJlY2VpdmVBdHRhY2soY29vcmRpbmF0ZXMpO1xuICAgIHJldHVybiBhdHRhY2tSZXN1bHRzO1xuICB9O1xuICBjb25zdCBnZW5lcmF0ZUNvbXB1dGVyU2hpcENvb3JkaW5hdGVzID0gKHNoaXBMZW5ndGgpID0+IHtcbiAgICBsZXQgbGlzdE9mQ29vcmRpbmF0ZXMgPSBbXTtcbiAgICBkbyB7XG4gICAgICBsaXN0T2ZDb29yZGluYXRlcyA9IFtdO1xuICAgICAgY29uc3Qgc3RhcnRpbmdDb29yZGluYXRlcyA9IGdlbmVyYXRlU3RhcnRpbmdDb29yZGluYXRlcygpO1xuICAgICAgY29uc3Qgbm9uU3RhcnRpbmdDb29yZGluYXRlcyA9IGdlbmVyYXRlTm9uU3RhcnRpbmdDb29yZGluYXRlcyhcbiAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlcyxcbiAgICAgICAgc2hpcExlbmd0aFxuICAgICAgKTtcbiAgICAgIGxpc3RPZkNvb3JkaW5hdGVzLnB1c2goc3RhcnRpbmdDb29yZGluYXRlcyk7XG4gICAgICBsaXN0T2ZDb29yZGluYXRlcyA9IGxpc3RPZkNvb3JkaW5hdGVzLmNvbmNhdChub25TdGFydGluZ0Nvb3JkaW5hdGVzKTtcbiAgICB9IHdoaWxlIChsaXN0T2ZDb29yZGluYXRlcy5sZW5ndGggPCBzaGlwTGVuZ3RoKTtcbiAgICByZXR1cm4gbGlzdE9mQ29vcmRpbmF0ZXM7XG4gIH07XG4gIGNvbnN0IGdlbmVyYXRlU3RhcnRpbmdDb29yZGluYXRlcyA9ICgpID0+IHtcbiAgICBjb25zdCBzdGFydGluZ0Nvb3JkaW5hdGVzID0gW3VuZGVmaW5lZCwgdW5kZWZpbmVkXTtcbiAgICBkbyB7XG4gICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzBdID0gZ2VuZXJhdGVSYW5kb21Db29yZGluYXRlKCk7XG4gICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzFdID0gZ2VuZXJhdGVSYW5kb21Db29yZGluYXRlKCk7XG4gICAgfSB3aGlsZSAocGxheWVyR2FtZWJvYXJkLmdldENvb3JkaW5hdGVzKHN0YXJ0aW5nQ29vcmRpbmF0ZXMpICE9PSB1bmRlZmluZWQpO1xuICAgIHJldHVybiBzdGFydGluZ0Nvb3JkaW5hdGVzO1xuICB9O1xuICBjb25zdCBnZW5lcmF0ZU5vblN0YXJ0aW5nQ29vcmRpbmF0ZXMgPSAoc3RhcnRpbmdDb29yZGluYXRlcywgc2hpcExlbmd0aCkgPT4ge1xuICAgIGNvbnN0IHBvc3NpYmxlQ29vcmRpbmF0ZXMgPSBbXTtcbiAgICBpZiAoY2hlY2tJZlZhbGlkRW1wdHlDb29yZGluYXRlcyhzdGFydGluZ0Nvb3JkaW5hdGVzLCBzaGlwTGVuZ3RoLCBcInVwXCIpKSB7XG4gICAgICBjb25zdCB1cENvb3JkaW5hdGVzID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICB1cENvb3JkaW5hdGVzLnB1c2goW1xuICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0gLSBpLFxuICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0sXG4gICAgICAgIF0pO1xuICAgICAgfVxuICAgICAgcG9zc2libGVDb29yZGluYXRlcy5wdXNoKHVwQ29vcmRpbmF0ZXMpO1xuICAgIH1cbiAgICBpZiAoXG4gICAgICBjaGVja0lmVmFsaWRFbXB0eUNvb3JkaW5hdGVzKHN0YXJ0aW5nQ29vcmRpbmF0ZXMsIHNoaXBMZW5ndGgsIFwicmlnaHRcIilcbiAgICApIHtcbiAgICAgIGNvbnN0IHJpZ2h0Q29vcmRpbmF0ZXMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgIHJpZ2h0Q29vcmRpbmF0ZXMucHVzaChbXG4gICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSxcbiAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzFdICsgaSxcbiAgICAgICAgXSk7XG4gICAgICB9XG4gICAgICBwb3NzaWJsZUNvb3JkaW5hdGVzLnB1c2gocmlnaHRDb29yZGluYXRlcyk7XG4gICAgfVxuICAgIGlmIChjaGVja0lmVmFsaWRFbXB0eUNvb3JkaW5hdGVzKHN0YXJ0aW5nQ29vcmRpbmF0ZXMsIHNoaXBMZW5ndGgsIFwiZG93blwiKSkge1xuICAgICAgY29uc3QgZG93bkNvb3JkaW5hdGVzID0gW107XG4gICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICBkb3duQ29vcmRpbmF0ZXMucHVzaChbXG4gICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSArIGksXG4gICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1sxXSxcbiAgICAgICAgXSk7XG4gICAgICB9XG4gICAgICBwb3NzaWJsZUNvb3JkaW5hdGVzLnB1c2goZG93bkNvb3JkaW5hdGVzKTtcbiAgICB9XG4gICAgaWYgKGNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMoc3RhcnRpbmdDb29yZGluYXRlcywgc2hpcExlbmd0aCwgXCJsZWZ0XCIpKSB7XG4gICAgICBjb25zdCBsZWZ0Q29vcmRpbmF0ZXMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgIGxlZnRDb29yZGluYXRlcy5wdXNoKFtcbiAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzBdLFxuICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gLSBpLFxuICAgICAgICBdKTtcbiAgICAgIH1cbiAgICAgIHBvc3NpYmxlQ29vcmRpbmF0ZXMucHVzaChsZWZ0Q29vcmRpbmF0ZXMpO1xuICAgIH1cbiAgICBpZiAocG9zc2libGVDb29yZGluYXRlcy5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBwb3NzaWJsZUNvb3JkaW5hdGVzO1xuICAgIH1cbiAgICBjb25zdCByYW5kb21JbmRleCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHBvc3NpYmxlQ29vcmRpbmF0ZXMubGVuZ3RoKTtcbiAgICByZXR1cm4gcG9zc2libGVDb29yZGluYXRlc1tyYW5kb21JbmRleF07XG4gIH07XG4gIGNvbnN0IGdlbmVyYXRlUmFuZG9tQ29vcmRpbmF0ZSA9ICgpID0+IHtcbiAgICBjb25zdCBCT0FSREFYRVNMRU5HVEggPSAxMDtcbiAgICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogQk9BUkRBWEVTTEVOR1RIKTtcbiAgfTtcbiAgY29uc3QgY2hlY2tJZlByZXZpb3VzbHlBdHRhY2tlZCA9IChhdHRhY2tDb29yZGluYXRlcykgPT4ge1xuICAgIGxldCBwcmV2aW91c2x5QXR0YWNrZWQgPSBmYWxzZTtcbiAgICBjb25zdCByZWNlaXZlZE1pc3NlZFNob3RzID0gb3Bwb3NpbmdQbGF5ZXJcbiAgICAgIC5nZXRHYW1lYm9hcmQoKVxuICAgICAgLmdldFJlY2VpdmVkTWlzc2VkU2hvdHMoKTtcbiAgICBjb25zdCByZWNlaXZlZEhpdFNob3RzID0gb3Bwb3NpbmdQbGF5ZXJcbiAgICAgIC5nZXRHYW1lYm9hcmQoKVxuICAgICAgLmdldFJlY2VpdmVkSGl0U2hvdHMoKTtcbiAgICBwcmV2aW91c2x5QXR0YWNrZWQgPSByZWNlaXZlZE1pc3NlZFNob3RzLnNvbWUoXG4gICAgICAoc2hvdCkgPT5cbiAgICAgICAgc2hvdFswXSA9PT0gYXR0YWNrQ29vcmRpbmF0ZXNbMF0gJiYgc2hvdFsxXSA9PT0gYXR0YWNrQ29vcmRpbmF0ZXNbMV1cbiAgICApO1xuICAgIGlmICghcHJldmlvdXNseUF0dGFja2VkKSB7XG4gICAgICBwcmV2aW91c2x5QXR0YWNrZWQgPSByZWNlaXZlZEhpdFNob3RzLnNvbWUoXG4gICAgICAgIChzaG90KSA9PlxuICAgICAgICAgIHNob3RbMF0gPT09IGF0dGFja0Nvb3JkaW5hdGVzWzBdICYmIHNob3RbMV0gPT09IGF0dGFja0Nvb3JkaW5hdGVzWzFdXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gcHJldmlvdXNseUF0dGFja2VkO1xuICB9O1xuICBjb25zdCBnZW5lcmF0ZUF0dGFja0Nvb3JkaW5hdGVzID0gKCkgPT4ge1xuICAgIGNvbnN0IGF0dGFja0Nvb3JkaW5hdGVzID0gW3VuZGVmaW5lZCwgdW5kZWZpbmVkXTtcbiAgICBkbyB7XG4gICAgICBhdHRhY2tDb29yZGluYXRlc1swXSA9IGdlbmVyYXRlUmFuZG9tQ29vcmRpbmF0ZSgpO1xuICAgICAgYXR0YWNrQ29vcmRpbmF0ZXNbMV0gPSBnZW5lcmF0ZVJhbmRvbUNvb3JkaW5hdGUoKTtcbiAgICB9IHdoaWxlIChjaGVja0lmUHJldmlvdXNseUF0dGFja2VkKGF0dGFja0Nvb3JkaW5hdGVzKSk7XG4gICAgcmV0dXJuIGF0dGFja0Nvb3JkaW5hdGVzO1xuICB9O1xuICBjb25zdCBjaGVja0lmVmFsaWRFbXB0eUNvb3JkaW5hdGVzID0gKFxuICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXMsXG4gICAgc2hpcExlbmd0aCxcbiAgICBkaXJlY3Rpb25cbiAgKSA9PiB7XG4gICAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICAgIGNhc2UgXCJ1cFwiOlxuICAgICAgICBpZiAoc3RhcnRpbmdDb29yZGluYXRlc1swXSAtIChzaGlwTGVuZ3RoIC0gMSkgPCAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgcGxheWVyR2FtZWJvYXJkLmdldENvb3JkaW5hdGVzKFtcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSAtIGksXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0sXG4gICAgICAgICAgICBdKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBjYXNlIFwicmlnaHRcIjpcbiAgICAgICAgaWYgKHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gKyAoc2hpcExlbmd0aCAtIDEpID4gOSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIHBsYXllckdhbWVib2FyZC5nZXRDb29yZGluYXRlcyhbXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0sXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gKyBpLFxuICAgICAgICAgICAgXSkgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgY2FzZSBcImRvd25cIjpcbiAgICAgICAgaWYgKHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0gKyAoc2hpcExlbmd0aCAtIDEpID4gOSkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIHBsYXllckdhbWVib2FyZC5nZXRDb29yZGluYXRlcyhbXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0gKyBpLFxuICAgICAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzFdLFxuICAgICAgICAgICAgXSkgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgY2FzZSBcImxlZnRcIjpcbiAgICAgICAgaWYgKHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gLSAoc2hpcExlbmd0aCAtIDEpIDwgMCkge1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8IHNoaXBMZW5ndGg7IGkrKykge1xuICAgICAgICAgIGlmIChcbiAgICAgICAgICAgIHBsYXllckdhbWVib2FyZC5nZXRDb29yZGluYXRlcyhbXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0sXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gLSBpLFxuICAgICAgICAgICAgXSkgIT09IHVuZGVmaW5lZFxuICAgICAgICAgICkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgZGVmYXVsdDpcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9O1xuICByZXR1cm4ge1xuICAgIGlzQ29tcHV0ZXIsXG4gICAgZ2V0R2FtZWJvYXJkLFxuICAgIGdldE9wcG9zaW5nUGxheWVyLFxuICAgIHNldE9wcG9zaW5nUGxheWVyLFxuICAgIGFkZFNoaXBUb0dhbWVib2FyZCxcbiAgICBzZW5kQXR0YWNrLFxuICAgIGluaXRpYWxpemVDb21wdXRlckdhbWVib2FyZCxcbiAgICBzZW5kQ29tcHV0ZXJBdHRhY2ssXG4gICAgcmVjZWl2ZUF0dGFjayxcbiAgICBjaGVja0lmVmFsaWRFbXB0eUNvb3JkaW5hdGVzLFxuICB9O1xufTtcblxuZXhwb3J0IHsgUGxheWVyIH07XG4iLCJjb25zdCBHYW1lYm9hcmQgPSAoKSA9PiB7XG4gIGNvbnN0IGNyZWF0ZUJvYXJkID0gKCkgPT4ge1xuICAgIGNvbnN0IGJvYXJkID0gW107XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCAxMDsgaSsrKSB7XG4gICAgICBib2FyZC5wdXNoKFtdKTtcbiAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgMTA7IGorKykge1xuICAgICAgICBib2FyZFtpXS5wdXNoKHVuZGVmaW5lZCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBib2FyZDtcbiAgfTtcbiAgY29uc3QgYm9hcmQgPSBjcmVhdGVCb2FyZCgpO1xuICBjb25zdCBwbGFjZWRTaGlwcyA9IFtdO1xuICBjb25zdCByZWNlaXZlZE1pc3NlZFNob3RzID0gW107XG4gIGNvbnN0IHJlY2VpdmVkSGl0U2hvdHMgPSBbXTtcbiAgY29uc3Qgc2VudE1pc3NlZFNob3RzID0gW107XG4gIGNvbnN0IHNlbnRIaXRTaG90cyA9IFtdO1xuICBsZXQgYWxsU2hpcHNTdW5rID0gZmFsc2U7XG4gIGNvbnN0IGdldENvb3JkaW5hdGVzID0gKGNvb3JkaW5hdGVzKSA9PiBib2FyZFtjb29yZGluYXRlc1swXV1bY29vcmRpbmF0ZXNbMV1dO1xuICBjb25zdCBnZXRQbGFjZWRTaGlwcyA9ICgpID0+IHBsYWNlZFNoaXBzO1xuICBjb25zdCBnZXRSZWNlaXZlZE1pc3NlZFNob3RzID0gKCkgPT4gcmVjZWl2ZWRNaXNzZWRTaG90cztcbiAgY29uc3QgZ2V0UmVjZWl2ZWRIaXRTaG90cyA9ICgpID0+IHJlY2VpdmVkSGl0U2hvdHM7XG4gIGNvbnN0IGdldFNlbnRNaXNzZWRTaG90cyA9ICgpID0+IHNlbnRNaXNzZWRTaG90cztcbiAgY29uc3QgZ2V0U2VudEhpdFNob3RzID0gKCkgPT4gc2VudEhpdFNob3RzO1xuICBjb25zdCBpc0FsbFNoaXBzU3VuayA9ICgpID0+IGFsbFNoaXBzU3VuaztcbiAgY29uc3QgcGxhY2VTaGlwID0gKHNoaXAsIGNvb3JkaW5hdGVzTGlzdCkgPT4ge1xuICAgIGZvciAoY29uc3QgY29vcmRpbmF0ZXMgb2YgY29vcmRpbmF0ZXNMaXN0KSB7XG4gICAgICBib2FyZFtjb29yZGluYXRlc1swXV1bY29vcmRpbmF0ZXNbMV1dID0gc2hpcDtcbiAgICB9XG4gICAgcGxhY2VkU2hpcHMucHVzaChzaGlwKTtcbiAgfTtcbiAgY29uc3QgY2hlY2tBbGxTaGlwc1N1bmsgPSAoKSA9PiB7XG4gICAgaWYgKHBsYWNlZFNoaXBzLmV2ZXJ5KChzaGlwKSA9PiBzaGlwLmlzU3VuaygpKSkge1xuICAgICAgYWxsU2hpcHNTdW5rID0gdHJ1ZTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IHJlY2VpdmVBdHRhY2sgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBjb25zdCBlbnRpdHlBdENvb3JkaW5hdGVzID0gZ2V0Q29vcmRpbmF0ZXMoY29vcmRpbmF0ZXMpO1xuICAgIGlmIChlbnRpdHlBdENvb3JkaW5hdGVzICE9PSB1bmRlZmluZWQpIHtcbiAgICAgIGVudGl0eUF0Q29vcmRpbmF0ZXMuaGl0KCk7XG4gICAgICBjaGVja0FsbFNoaXBzU3VuaygpO1xuICAgICAgcmVjZWl2ZWRIaXRTaG90cy5wdXNoKGNvb3JkaW5hdGVzKTtcbiAgICAgIHJldHVybiBcImhpdFwiO1xuICAgIH1cbiAgICByZWNlaXZlZE1pc3NlZFNob3RzLnB1c2goY29vcmRpbmF0ZXMpO1xuICAgIHJldHVybiBcIm1pc3NcIjtcbiAgfTtcbiAgY29uc3QgYWRkU2VudE1pc3NlZFNob3QgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBzZW50TWlzc2VkU2hvdHMucHVzaChjb29yZGluYXRlcyk7XG4gIH07XG4gIGNvbnN0IGFkZFNlbnRIaXRTaG90ID0gKGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgc2VudEhpdFNob3RzLnB1c2goY29vcmRpbmF0ZXMpO1xuICB9O1xuICByZXR1cm4ge1xuICAgIGdldENvb3JkaW5hdGVzLFxuICAgIGdldFBsYWNlZFNoaXBzLFxuICAgIGdldFJlY2VpdmVkTWlzc2VkU2hvdHMsXG4gICAgZ2V0UmVjZWl2ZWRIaXRTaG90cyxcbiAgICBnZXRTZW50TWlzc2VkU2hvdHMsXG4gICAgZ2V0U2VudEhpdFNob3RzLFxuICAgIGlzQWxsU2hpcHNTdW5rLFxuICAgIHBsYWNlU2hpcCxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGFkZFNlbnRNaXNzZWRTaG90LFxuICAgIGFkZFNlbnRIaXRTaG90LFxuICB9O1xufTtcblxuZXhwb3J0IHsgR2FtZWJvYXJkIH07XG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9wbGF5ZXJcIjtcbmltcG9ydCB7IERPTUNvbnRyb2xsZXIgfSBmcm9tIFwiLi9ET01fY29udHJvbGxlclwiO1xuXG5jb25zdCBHYW1lTG9vcCA9ICgoKSA9PiB7XG4gIGNvbnN0IHBsYXllcnMgPSBbXTtcbiAgbGV0IGluUHJvZ3Jlc3MgPSB0cnVlO1xuICBsZXQgd2lubmVyO1xuICBsZXQgbWlkQXR0YWNrID0gZmFsc2U7XG4gIGNvbnN0IGdldFBsYXllcnMgPSAoKSA9PiBwbGF5ZXJzO1xuICBjb25zdCBpc0luUHJvZ3Jlc3MgPSAoKSA9PiBpblByb2dyZXNzO1xuICBjb25zdCBnZXRXaW5uZXIgPSAoKSA9PiB3aW5uZXI7XG4gIGNvbnN0IGlzTWlkQXR0YWNrID0gKCkgPT4gbWlkQXR0YWNrO1xuICBjb25zdCB0b2dnbGVNaWRBdHRhY2sgPSAoc3RhdGUpID0+IHtcbiAgICBzdGF0ZSA/IChtaWRBdHRhY2sgPSB0cnVlKSA6IChtaWRBdHRhY2sgPSBmYWxzZSk7XG4gIH07XG4gIGNvbnN0IGNyZWF0ZUdhbWUgPSAoKSA9PiB7XG4gICAgY29uc3QgaHVtYW5QbGF5ZXIgPSBQbGF5ZXIoXCJodW1hblwiKTtcbiAgICBwbGF5ZXJzLnB1c2goaHVtYW5QbGF5ZXIpO1xuICAgIGNvbnN0IGNvbXB1dGVyUGxheWVyID0gUGxheWVyKFwiY29tcHV0ZXJcIik7XG4gICAgcGxheWVycy5wdXNoKGNvbXB1dGVyUGxheWVyKTtcbiAgICBodW1hblBsYXllci5zZXRPcHBvc2luZ1BsYXllcihjb21wdXRlclBsYXllcik7XG4gICAgY29tcHV0ZXJQbGF5ZXIuc2V0T3Bwb3NpbmdQbGF5ZXIoaHVtYW5QbGF5ZXIpO1xuICAgIGNvbXB1dGVyUGxheWVyLmluaXRpYWxpemVDb21wdXRlckdhbWVib2FyZCgpO1xuICB9O1xuICBjb25zdCBlbmRHYW1lID0gKGxvc2VyUGxheWVyKSA9PiB7XG4gICAgY29uc3Qgd2lubmVyUGxheWVyID0gbG9zZXJQbGF5ZXIuZ2V0T3Bwb3NpbmdQbGF5ZXIoKTtcbiAgICBpblByb2dyZXNzID0gZmFsc2U7XG4gICAgd2lubmVyID0gd2lubmVyUGxheWVyO1xuICAgIERPTUNvbnRyb2xsZXIudG9nZ2xlQWJpbGl0eVRvQXR0YWNrKFwiZGlzYWJsZVwiKTtcbiAgICBET01Db250cm9sbGVyLmRpc3BsYXlXaW5uZXIod2lubmVyKTtcbiAgfTtcbiAgY29uc3QgcmVzZXRHYW1lTG9vcFN0YXRlID0gKCkgPT4ge1xuICAgIHBsYXllcnMubGVuZ3RoID0gMDtcbiAgICBpblByb2dyZXNzID0gdHJ1ZTtcbiAgICB3aW5uZXIgPSB1bmRlZmluZWQ7XG4gIH07XG4gIGNvbnN0IHJlc2V0R2FtZSA9ICgpID0+IHtcbiAgICByZXNldEdhbWVMb29wU3RhdGUoKTtcbiAgICBET01Db250cm9sbGVyLnJlc2V0RE9NKCk7XG4gICAgY3JlYXRlR2FtZSgpO1xuICAgIERPTUNvbnRyb2xsZXIuaW5pdGlhbGl6ZUJvYXJkRE9NKCk7XG4gIH07XG4gIHJldHVybiB7XG4gICAgZ2V0UGxheWVycyxcbiAgICBpc0luUHJvZ3Jlc3MsXG4gICAgZ2V0V2lubmVyLFxuICAgIGlzTWlkQXR0YWNrLFxuICAgIHRvZ2dsZU1pZEF0dGFjayxcbiAgICBjcmVhdGVHYW1lLFxuICAgIGVuZEdhbWUsXG4gICAgcmVzZXRHYW1lLFxuICAgIHJlc2V0R2FtZUxvb3BTdGF0ZSxcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCB7IEdhbWVMb29wIH07XG4iLCJpbXBvcnQgeyBET01Db250cm9sbGVyIH0gZnJvbSBcIi4vRE9NX2NvbnRyb2xsZXJcIjtcbmltcG9ydCB7IEdhbWVMb29wIH0gZnJvbSBcIi4vZ2FtZWxvb3BcIjtcblxuY29uc3QgRXZlbnRMaXN0ZW5lckNvbnRyb2xsZXIgPSAoKCkgPT4ge1xuICBjb25zdCByb3RhdGVTaGlwSW1hZ2VMaXN0ZW5lcnMgPSAoKSA9PiB7XG4gICAgY29uc3Qgc2hpcFBsYWNlbWVudEVsZW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zaGlwLXBsYWNlbWVudFwiKTtcbiAgICBzaGlwUGxhY2VtZW50RWxlbWVudHMuZm9yRWFjaCgoZ3JvdXBPZkVsZW1lbnRzKSA9PiB7XG4gICAgICBjb25zdCBpbWFnZUVsZW1lbnQgPSBncm91cE9mRWxlbWVudHMucXVlcnlTZWxlY3RvcihcImltZ1wiKTtcbiAgICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBncm91cE9mRWxlbWVudHMucXVlcnlTZWxlY3RvcihcImJ1dHRvblwiKTtcbiAgICAgIGJ1dHRvbkVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgRE9NQ29udHJvbGxlci5yb3RhdGVTaGlwSW1hZ2UoaW1hZ2VFbGVtZW50KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuICBjb25zdCBhZGRTaGlwUGxhY2VtZW50RHJhZyA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwSW1hZ2VzID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNoaXAtcGllY2VcIikpO1xuICAgIHNoaXBJbWFnZXMuZm9yRWFjaCgoc2hpcCkgPT4ge1xuICAgICAgc2hpcC5hZGRFdmVudExpc3RlbmVyKFwiZHJhZ3N0YXJ0XCIsIChldmVudCkgPT4ge1xuICAgICAgICBET01Db250cm9sbGVyLmdldERyYWdnZWRJbWFnZShldmVudCk7XG4gICAgICAgIERPTUNvbnRyb2xsZXIucm90YXRlRHJhZ2dlZEltYWdlKGV2ZW50KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuICBjb25zdCBhZGRQbGF5QWdhaW5MaXN0ZW5lciA9ICgpID0+IHtcbiAgICBjb25zdCBwbGF5QWdhaW5CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnBsYXktYWdhaW5cIik7XG4gICAgcGxheUFnYWluQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICBHYW1lTG9vcC5yZXNldEdhbWUoKTtcbiAgICB9KTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICByb3RhdGVTaGlwSW1hZ2VMaXN0ZW5lcnMsXG4gICAgYWRkU2hpcFBsYWNlbWVudERyYWcsXG4gICAgYWRkUGxheUFnYWluTGlzdGVuZXIsXG4gIH07XG59KSgpO1xuXG5leHBvcnQgeyBFdmVudExpc3RlbmVyQ29udHJvbGxlciB9O1xuIiwiaW1wb3J0IHsgR2FtZUxvb3AgfSBmcm9tIFwiLi9nYW1lbG9vcFwiO1xuaW1wb3J0IHsgRE9NQ29udHJvbGxlciB9IGZyb20gXCIuL0RPTV9jb250cm9sbGVyXCI7XG5pbXBvcnQgeyBFdmVudExpc3RlbmVyQ29udHJvbGxlciB9IGZyb20gXCIuL2V2ZW50X2xpc3RlbmVyX2NvbnRyb2xsZXJcIjtcblxuR2FtZUxvb3AuY3JlYXRlR2FtZSgpO1xuXG5ET01Db250cm9sbGVyLmluaXRpYWxpemVCb2FyZERPTSgpO1xuXG5FdmVudExpc3RlbmVyQ29udHJvbGxlci5yb3RhdGVTaGlwSW1hZ2VMaXN0ZW5lcnMoKTtcblxuRXZlbnRMaXN0ZW5lckNvbnRyb2xsZXIuYWRkU2hpcFBsYWNlbWVudERyYWcoKTtcblxuRXZlbnRMaXN0ZW5lckNvbnRyb2xsZXIuYWRkUGxheUFnYWluTGlzdGVuZXIoKTtcbiJdLCJuYW1lcyI6WyJET01Db250cm9sbGVyIiwiY3JlYXRlQm9hcmRDZWxscyIsImdhbWVib2FyZERPTSIsImNvbHVtbkxhYmVscyIsInJvd0xhYmVscyIsImh1bWFuUGxheWVyT2JqZWN0IiwiR2FtZUxvb3AiLCJnZXRQbGF5ZXJzIiwiaSIsImoiLCJpbnZpc2libGVQbGFjZWhvbGRlckVsZW1lbnQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc0xpc3QiLCJhZGQiLCJzdHlsZSIsInZpc2liaWxpdHkiLCJhcHBlbmRDaGlsZCIsImNvbHVtbkxhYmVsRWxlbWVudCIsInRleHRDb250ZW50Iiwicm93TGFiZWxFbGVtZW50IiwiQXJyYXkiLCJmcm9tIiwiaW5jbHVkZXMiLCJwbGF5ZXJDZWxsRWxlbWVudCIsInNldEF0dHJpYnV0ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsImRyYWdPdmVyIiwiaW5zZXJ0RHJhZ2dlZEltYWdlIiwiZ2V0R2FtZWJvYXJkIiwiZ2V0UGxhY2VkU2hpcHMiLCJsZW5ndGgiLCJ0b2dnbGVBYmlsaXR5VG9BdHRhY2siLCJjb21wdXRlckNlbGxFbGVtZW50IiwiZGlzYWJsZWQiLCJpc01pZEF0dGFjayIsImNlbGxSb3ciLCJOdW1iZXIiLCJkYXRhc2V0Iiwicm93IiwiY2VsbENvbHVtbiIsImNvbHVtbiIsInNlbmRBdHRhY2siLCJhY3Rpb24iLCJjb21wdXRlckdhbWVib2FyZEVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY2VsbEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJjZWxsRWxlbWVudCIsInByZXZlbnREZWZhdWx0IiwiY3JlYXRlRXJyb3JNZXNzYWdlIiwiZXJyb3JNZXNzYWdlIiwiYm9keSIsInNldFRpbWVvdXQiLCJyZW1vdmVDaGlsZCIsInRhcmdldENlbGwiLCJ0YXJnZXQiLCJkYXRhU3RyaW5nIiwiZGF0YVRyYW5zZmVyIiwiZ2V0RGF0YSIsImRhdGFPYmplY3QiLCJKU09OIiwicGFyc2UiLCJjZWxsQ29vcmRpbmF0ZXMiLCJzaGlwTGVuZ3RoIiwiaG9yaXpvbnRhbCIsImNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMiLCJ2ZXJ0aWNhbCIsImlzVmFsaWRHYW1lYm9hcmRDZWxsIiwic2hpcENvb3JkaW5hdGVzIiwidGFyZ2V0Q2VsbFJvdyIsInRhcmdldENlbGxDb2x1bW4iLCJjb29yZGluYXRlc0FycmF5IiwicmVtYWluaW5nQ2VsbCIsInB1c2giLCJhZGRTaGlwVG9ET00iLCJhZGRTaGlwVG9HYW1lYm9hcmQiLCJJRCIsImVsZW1lbnRJRCIsImltYWdlRWxlbWVudCIsImJ1dHRvbkVsZW1lbnQiLCJwYXJlbnROb2RlIiwiZGlzYWJsZUltYWdlQnV0dG9uSW50ZXJhY3Rpb25zIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImluaXRpYWxpemVCb2FyZERPTSIsImh1bWFuUGxheWVyR2FtZWJvYXJkRE9NIiwiY29tcHV0ZXJHYW1lYm9hcmRET00iLCJyb3RhdGVTaGlwSW1hZ2UiLCJpbWFnZSIsImltYWdlQ2xhc3NlcyIsInJlbW92ZSIsInJvdGF0ZURyYWdnZWRJbWFnZSIsImNsb25lZEltYWdlRWxlbWVudCIsImNsb25lTm9kZSIsInRlbXBEaXYiLCJjbG9uZWRJbWFnZUVsZW1lbnRDbGFzc2VzIiwicm90YXRlUGVyTGVuZ3RoIiwic2V0RHJhZ0ltYWdlIiwiZ2V0RHJhZ2dlZEltYWdlIiwic3JjIiwiZ2V0QXR0cmlidXRlIiwic3RyaW5naWZ5Iiwic2V0RGF0YSIsImFkZEF0dGFja1Jlc3VsdERPTSIsInBsYXllclR5cGUiLCJhdHRhY2tSZXN1bHRzIiwiY29vcmRpbmF0ZXMiLCJhdHRhY2tSZXN1bHRzRWxlbWVudCIsImRpc3BsYXlXaW5uZXIiLCJ3aW5uaW5nUGxheWVyIiwiaXNDb21wdXRlciIsInJlc2V0RE9NIiwiaW5uZXJIVE1MIiwiYnV0dG9uIiwiZ2FtZVJlc3VsdHNFbGVtZW50IiwicmVzZXRHYW1lUmVzdWx0cyIsIlBsYXllciIsImNvbXB1dGVyUGxheWVyIiwicGxheWVyR2FtZWJvYXJkIiwiYm9hcmQiLCJ1bmRlZmluZWQiLCJjcmVhdGVCb2FyZCIsInBsYWNlZFNoaXBzIiwicmVjZWl2ZWRNaXNzZWRTaG90cyIsInJlY2VpdmVkSGl0U2hvdHMiLCJzZW50TWlzc2VkU2hvdHMiLCJzZW50SGl0U2hvdHMiLCJhbGxTaGlwc1N1bmsiLCJnZXRDb29yZGluYXRlcyIsImdldFJlY2VpdmVkTWlzc2VkU2hvdHMiLCJnZXRSZWNlaXZlZEhpdFNob3RzIiwiZ2V0U2VudE1pc3NlZFNob3RzIiwiZ2V0U2VudEhpdFNob3RzIiwiaXNBbGxTaGlwc1N1bmsiLCJwbGFjZVNoaXAiLCJzaGlwIiwiY29vcmRpbmF0ZXNMaXN0IiwicmVjZWl2ZUF0dGFjayIsImVudGl0eUF0Q29vcmRpbmF0ZXMiLCJoaXQiLCJldmVyeSIsImlzU3VuayIsImFkZFNlbnRNaXNzZWRTaG90IiwiYWRkU2VudEhpdFNob3QiLCJHYW1lYm9hcmQiLCJvcHBvc2luZ1BsYXllciIsImdpdmVuTGVuZ3RoIiwiaGl0cyIsInN1bmsiLCJnZXRTaGlwTGVuZ3RoIiwiZ2V0U2hpcEhpdHMiLCJTaGlwIiwiY2hlY2tJZlByZXZpb3VzbHlBdHRhY2tlZCIsImlzSW5Qcm9ncmVzcyIsIm9wcG9zaW5nUGxheWVyR2FtZWJvYXJkIiwiZW5kR2FtZSIsInRvZ2dsZU1pZEF0dGFjayIsInJhbmRvbURlbGF5IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic2VuZENvbXB1dGVyQXR0YWNrIiwiZ2VuZXJhdGVDb21wdXRlclNoaXBDb29yZGluYXRlcyIsImxpc3RPZkNvb3JkaW5hdGVzIiwic3RhcnRpbmdDb29yZGluYXRlcyIsImdlbmVyYXRlU3RhcnRpbmdDb29yZGluYXRlcyIsIm5vblN0YXJ0aW5nQ29vcmRpbmF0ZXMiLCJnZW5lcmF0ZU5vblN0YXJ0aW5nQ29vcmRpbmF0ZXMiLCJjb25jYXQiLCJnZW5lcmF0ZVJhbmRvbUNvb3JkaW5hdGUiLCJwb3NzaWJsZUNvb3JkaW5hdGVzIiwidXBDb29yZGluYXRlcyIsInJpZ2h0Q29vcmRpbmF0ZXMiLCJkb3duQ29vcmRpbmF0ZXMiLCJsZWZ0Q29vcmRpbmF0ZXMiLCJhdHRhY2tDb29yZGluYXRlcyIsInByZXZpb3VzbHlBdHRhY2tlZCIsInNvbWUiLCJzaG90IiwiZGlyZWN0aW9uIiwiZ2V0T3Bwb3NpbmdQbGF5ZXIiLCJzZXRPcHBvc2luZ1BsYXllciIsInBsYXllciIsImluaXRpYWxpemVDb21wdXRlckdhbWVib2FyZCIsImxlbmd0aHNPZlNoaXBzIiwiZ2VuZXJhdGVBdHRhY2tDb29yZGluYXRlcyIsInBsYXllcnMiLCJ3aW5uZXIiLCJpblByb2dyZXNzIiwibWlkQXR0YWNrIiwiY3JlYXRlR2FtZSIsImh1bWFuUGxheWVyIiwicmVzZXRHYW1lTG9vcFN0YXRlIiwiZ2V0V2lubmVyIiwic3RhdGUiLCJsb3NlclBsYXllciIsIndpbm5lclBsYXllciIsInJlc2V0R2FtZSIsIkV2ZW50TGlzdGVuZXJDb250cm9sbGVyIiwiZ3JvdXBPZkVsZW1lbnRzIl0sInNvdXJjZVJvb3QiOiIifQ==