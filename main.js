(()=>{"use strict";const e=(()=>{const e=e=>{const s=["A","B","C","D","E","F","G","H","I","J"],i=["1","2","3","4","5","6","7","8","9","10"],d=a.getPlayers()[0];for(let n=-1;n<10;n++)for(let l=-1;l<10;l++)if(-1===n)if(-1===l){const t=document.createElement("div");t.classList.add("gameboard-label"),t.style.visibility="hidden",e.appendChild(t)}else{const t=document.createElement("div");t.classList.add("column-label"),t.textContent=s[l],e.appendChild(t)}else if(-1===l){const t=document.createElement("div");t.classList.add("row-label"),t.textContent=i[n],e.appendChild(t)}else if(Array.from(e.classList).includes("player-board")){const a=document.createElement("div");a.setAttribute("data-row",n),a.setAttribute("data-column",l),a.classList.add("gameboard-cell"),a.addEventListener("dragover",(e=>{r(e)})),a.addEventListener("drop",(e=>{o(e),5===d.getGameboard().getPlacedShips().length&&t("enable")})),e.appendChild(a)}else if(Array.from(e.classList).includes("computer-board")){const t=document.createElement("button");t.setAttribute("data-row",n),t.setAttribute("data-column",l),t.classList.add("gameboard-cell"),t.disabled=!0,t.addEventListener("click",(()=>{if(!a.isMidAttack()){const e=Number(t.dataset.row),a=Number(t.dataset.column);d.sendAttack([e,a])}})),e.appendChild(t)}},t=e=>{const t=document.querySelector(".computer-board"),a=Array.from(t.querySelectorAll(".gameboard-cell"));"enable"===e?a.forEach((e=>{e.disabled=!1})):"disable"===e&&a.forEach((e=>{e.disabled=!0}))},r=e=>{e.preventDefault()},s=()=>{const e=document.createElement("p");e.textContent="That is an invalid position.",e.classList.add("error-message"),document.body.appendChild(e),setTimeout((()=>{document.body.removeChild(e)}),2500)},o=e=>{e.preventDefault();const t=a.getPlayers()[0],r=e.target;if(Array.from(r.classList).includes("contains-ship-image"))return void s();const i=e.dataTransfer.getData("image"),d=JSON.parse(i);if(!((e,t)=>{const r=[Number(e.dataset.row),Number(e.dataset.column)],s=Number(t.shipLength);return t.horizontal?!!a.getPlayers()[0].checkIfValidEmptyCoordinates(r,s,"right"):t.vertical?!!a.getPlayers()[0].checkIfValidEmptyCoordinates(r,s,"down"):void 0})(r,d))return void s();const n=((e,t)=>{const a=t.shipLength,r=Number(e.dataset.row),s=Number(e.dataset.column),o=[[r,s]];e.classList.add("contains-ship-image"),e.classList.add("ship-image"),e.classList.add(`ship-image-${a}`),e.classList.add(`ship-image-${a}-1`),t.horizontal?e.classList.add("horizontal"):t.vertical&&e.classList.add("vertical");for(let e=1;e<a;e++){let i;t.horizontal?(i=document.querySelector(`.player-board [data-row='${r}'][data-column='${s+e}']`),i.classList.add("horizontal"),o.push([r,s+e])):t.vertical&&(i=document.querySelector(`.player-board [data-row='${r+e}'][data-column='${s}']`),i.classList.add("vertical"),o.push([r+e,s])),i.classList.add("contains-ship-image"),i.classList.add("ship-image"),i.classList.add(`ship-image-${a}`),i.classList.add(`ship-image-${a}-${e+1}`)}return o})(r,d);t.addShipToGameboard(Number(d.shipLength),n),(e=>{const t=e.elementID,a=document.querySelector(`#${t}`),r=a.parentNode.querySelector("button");a.setAttribute("draggable",!1),a.classList.add("disabled-image"),r.disabled=!0})(d),r.removeEventListener("drop",o)};return{initializeBoardDOM:()=>{const t=document.querySelector(".player-board"),a=document.querySelector(".computer-board");e(t),e(a)},insertDraggedImage:o,rotateShipImage:e=>{const t=Array.from(e.classList);t.includes("horizontal")?(e.classList.remove("horizontal"),e.classList.add("vertical")):t.includes("vertical")&&(e.classList.remove("vertical"),e.classList.add("horizontal"))},rotateDraggedImage:e=>{const t=e.target.cloneNode(),a=document.createElement("div");a.classList.add("temp-rotate"),((e,t)=>{const a=Array.from(t.classList);a.includes("horizontal")?e.classList.add("temp-rotate-horizontal"):a.includes("vertical")&&(e.classList.add("temp-rotate-vertical"),"5"===t.dataset.shipLength?e.classList.add("temp-rotate-vertical-5"):"4"===t.dataset.shipLength?e.classList.add("temp-rotate-vertical-4"):"3"===t.dataset.shipLength?e.classList.add("temp-rotate-vertical-3"):"2"===t.dataset.shipLength&&e.classList.add("temp-rotate-vertical-2"))})(a,t),a.appendChild(t),document.body.appendChild(a),e.dataTransfer.setDragImage(a,0,0),setTimeout((()=>{document.body.removeChild(a)}),0)},getDraggedImage:e=>{const t={image:e.target.src,shipLength:e.target.dataset.shipLength,horizontal:!1,vertical:!1,elementID:e.target.getAttribute("id")};Array.from(e.target.classList).includes("horizontal")?t.horizontal=!0:Array.from(e.target.classList).includes("vertical")&&(t.vertical=!0);const a=JSON.stringify(t);e.dataTransfer.setData("image",a)},dragOver:r,addAttackResultDOM:(e,t,a)=>{const r=a[0],s=a[1],o=document.querySelector(`.${e}-board`).querySelector(`[data-row='${r}'][data-column='${s}']`),i=document.createElement("img");i.classList.add("attack-results"),o.appendChild(i),"hit"===t?i.setAttribute("src","../dist/red_X.png"):i.setAttribute("src","../dist/white_O.png"),o.disabled=!0},toggleAbilityToAttack:t,displayWinner:e=>{const t=e.isComputer();document.querySelector(".game-results").classList.remove("default-hidden");document.querySelector(".display-winner").textContent=t?"Oh no, you lost! Try again!":"Congratulations, you won!"},resetDOM:()=>{document.querySelector(".player-board").innerHTML="",document.querySelector(".computer-board").innerHTML="",Array.from(document.querySelectorAll(".ship-piece")).forEach((e=>{e.setAttribute("draggable",!0),e.classList.remove("disabled-image"),Array.from(e.classList).includes("vertical")&&(e.classList.remove("vertical"),e.classList.add("horizontal"))})),Array.from(document.querySelectorAll(".rotate-ship")).forEach((e=>{e.disabled=!1})),(()=>{const e=document.querySelector(".game-results");e.classList.add("default-hidden"),e.querySelector(".display-winner").textContent="Placeholder"})()}}})(),t=t=>{const r="human"!==t&&("computer"===t||void 0),s=(()=>{const e=(()=>{const e=[];for(let t=0;t<10;t++){e.push([]);for(let a=0;a<10;a++)e[t].push(void 0)}return e})(),t=[],a=[],r=[],s=[],o=[];let i=!1;const d=t=>e[t[0]][t[1]];return{getCoordinates:d,getPlacedShips:()=>t,getReceivedMissedShots:()=>a,getReceivedHitShots:()=>r,getSentMissedShots:()=>s,getSentHitShots:()=>o,isAllShipsSunk:()=>i,placeShip:(a,r)=>{for(const t of r)e[t[0]][t[1]]=a;t.push(a)},receiveAttack:e=>{const s=d(e);return void 0!==s?(s.hit(),t.every((e=>e.isSunk()))&&(i=!0),r.push(e),"hit"):(a.push(e),"miss")},addSentMissedShot:e=>{s.push(e)},addSentHitShot:e=>{o.push(e)}}})();let o;const i=()=>r,d=(e,t)=>{const a=(e=>{const t=e;let a=0,r=!1;return{getShipLength:()=>t,getShipHits:()=>a,isSunk:()=>r,hit:()=>{if(r)return"That ship has already been sunk!";a+=1,a===t&&(r=!0)}}})(e);s.placeShip(a,t)},n=t=>{if(h(t)||!a.isInProgress()||a.isMidAttack())return;const r=o.getGameboard(),d=o.receiveAttack(t);if("hit"===d){if(s.addSentHitShot(t),i()?i()&&e.addAttackResultDOM("player",d,t):e.addAttackResultDOM("computer",d,t),r.isAllShipsSunk())return void a.endGame(o)}else"miss"===d&&(s.addSentMissedShot(t),i()?i()&&e.addAttackResultDOM("player",d,t):e.addAttackResultDOM("computer",d,t));o.isComputer()&&(a.toggleMidAttack(!0),setTimeout((()=>{a.toggleMidAttack(!1),o.sendComputerAttack()}),0))},l=e=>{let t=[];do{t=[];const a=c(),r=u(a,e);t.push(a),t=t.concat(r)}while(t.length<e);return t},c=()=>{const e=[void 0,void 0];do{e[0]=m(),e[1]=m()}while(void 0!==s.getCoordinates(e));return e},u=(e,t)=>{const a=[];if(p(e,t,"up")){const r=[];for(let a=1;a<t;a++)r.push([e[0]-a,e[1]]);a.push(r)}if(p(e,t,"right")){const r=[];for(let a=1;a<t;a++)r.push([e[0],e[1]+a]);a.push(r)}if(p(e,t,"down")){const r=[];for(let a=1;a<t;a++)r.push([e[0]+a,e[1]]);a.push(r)}if(p(e,t,"left")){const r=[];for(let a=1;a<t;a++)r.push([e[0],e[1]-a]);a.push(r)}return 0===a.length?a:a[Math.floor(Math.random()*a.length)]},m=()=>Math.floor(10*Math.random()),h=e=>{let t=!1;const a=o.getGameboard().getReceivedMissedShots(),r=o.getGameboard().getReceivedHitShots();return t=a.some((t=>t[0]===e[0]&&t[1]===e[1])),t||(t=r.some((t=>t[0]===e[0]&&t[1]===e[1]))),t},p=(e,t,a)=>{switch(a){case"up":if(e[0]-(t-1)<0)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0]-a,e[1]]))return!1;return!0;case"right":if(e[1]+(t-1)>9)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0],e[1]+a]))return!1;return!0;case"down":if(e[0]+(t-1)>9)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0]+a,e[1]]))return!1;return!0;case"left":if(e[1]-(t-1)<0)return!1;for(let a=1;a<t;a++)if(void 0!==s.getCoordinates([e[0],e[1]-a]))return!1;return!0}};return{isComputer:i,getGameboard:()=>s,getOpposingPlayer:()=>o,setOpposingPlayer:e=>{o=e},addShipToGameboard:d,sendAttack:n,initializeComputerGameboard:()=>{if(!r)return;const e=[5,4,3,3,2];for(const t of e){const e=l(t);d(t,e)}},sendComputerAttack:()=>{if(!r||!a.isInProgress())return;const e=(()=>{const e=[void 0,void 0];do{e[0]=m(),e[1]=m()}while(h(e));return e})();n(e)},receiveAttack:e=>s.receiveAttack(e),checkIfValidEmptyCoordinates:p}},a=(()=>{const a=[];let r,s=!0,o=!1;const i=()=>{const e=t("human");a.push(e);const r=t("computer");a.push(r),e.setOpposingPlayer(r),r.setOpposingPlayer(e),r.initializeComputerGameboard()},d=()=>{a.length=0,s=!0,r=void 0};return{getPlayers:()=>a,isInProgress:()=>s,getWinner:()=>r,isMidAttack:()=>o,toggleMidAttack:e=>{o=!!e},createGame:i,endGame:t=>{const a=t.getOpposingPlayer();s=!1,r=a,e.toggleAbilityToAttack("disable"),e.displayWinner(r)},resetGame:()=>{d(),e.resetDOM(),i(),e.initializeBoardDOM()},resetGameLoopState:d}})(),r=()=>{document.querySelectorAll(".ship-placement").forEach((t=>{const a=t.querySelector("img");t.querySelector("button").addEventListener("click",(()=>{e.rotateShipImage(a)}))}))},s=()=>{Array.from(document.querySelectorAll(".ship-piece")).forEach((t=>{t.addEventListener("dragstart",(t=>{e.getDraggedImage(t),e.rotateDraggedImage(t)}))}))},o=()=>{document.querySelector(".play-again").addEventListener("click",(()=>{a.resetGame()}))};a.createGame(),e.initializeBoardDOM(),r(),s(),o()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFZZixvQkFDakNRLEdBQWEsRUFDYkQsRUFBU1MsRUFDVHJNLEVBQWNpQyxzQkFBc0IsV0FDcENqQyxFQUFjOEcsY0FBYzhFLEVBQU8sRUFxQm5DVSxVQWRnQixLQUNoQkwsSUFDQWpNLEVBQWNpSCxXQUNkOEUsSUFDQS9MLEVBQWNzRixvQkFBb0IsRUFXbEMyRyxxQkFFSCxFQWxEZ0IsR0NBWE0sRUFDNkIsS0FDRDVMLFNBQVNxQyxpQkFBaUIsbUJBQ2xDQyxTQUFTdUosSUFDN0IsTUFBTXZILEVBQWV1SCxFQUFnQjFKLGNBQWMsT0FDN0IwSixFQUFnQjFKLGNBQWMsVUFDdENwQixpQkFBaUIsU0FBUyxLQUN0QzFCLEVBQWN5RixnQkFBZ0JSLEVBQWEsR0FDM0MsR0FDRixFQVRBc0gsRUFXeUIsS0FDUmxMLE1BQU1DLEtBQUtYLFNBQVNxQyxpQkFBaUIsZ0JBQzdDQyxTQUFTd0YsSUFDbEJBLEVBQUsvRyxpQkFBaUIsYUFBY0MsSUFDbEMzQixFQUFjb0csZ0JBQWdCekUsR0FDOUIzQixFQUFjNkYsbUJBQW1CbEUsRUFBTSxHQUN2QyxHQUNGLEVBbEJBNEssRUFvQnlCLEtBQ0g1TCxTQUFTbUMsY0FBYyxlQUMvQnBCLGlCQUFpQixTQUFTLEtBQ3hDcEIsRUFBU2dNLFdBQVcsR0FDcEIsRUN2Qk5oTSxFQUFTeUwsYUFFVC9MLEVBQWNzRixxQkFFZGlILElBRUFBLElBRUFBLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvc2hpcC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvRE9NX2NvbnRyb2xsZXIuanMiLCJ3ZWJwYWNrOi8vb2Rpbi1iYXR0bGVzaGlwLy4vc3JjL3BsYXllci5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZ2FtZWJvYXJkLmpzIiwid2VicGFjazovL29kaW4tYmF0dGxlc2hpcC8uL3NyYy9nYW1lbG9vcC5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvZXZlbnRfbGlzdGVuZXJfY29udHJvbGxlci5qcyIsIndlYnBhY2s6Ly9vZGluLWJhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgU2hpcCA9IChnaXZlbkxlbmd0aCkgPT4ge1xuICBjb25zdCBsZW5ndGggPSBnaXZlbkxlbmd0aDtcbiAgbGV0IGhpdHMgPSAwO1xuICBsZXQgc3VuayA9IGZhbHNlO1xuICBjb25zdCBnZXRTaGlwTGVuZ3RoID0gKCkgPT4gbGVuZ3RoO1xuICBjb25zdCBnZXRTaGlwSGl0cyA9ICgpID0+IGhpdHM7XG4gIGNvbnN0IGlzU3VuayA9ICgpID0+IHN1bms7XG4gIGNvbnN0IGNoZWNrSWZTdW5rID0gKCkgPT4ge1xuICAgIGlmIChoaXRzID09PSBsZW5ndGgpIHtcbiAgICAgIHN1bmsgPSB0cnVlO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgaGl0ID0gKCkgPT4ge1xuICAgIGlmICghc3Vuaykge1xuICAgICAgaGl0cyArPSAxO1xuICAgICAgY2hlY2tJZlN1bmsoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIFwiVGhhdCBzaGlwIGhhcyBhbHJlYWR5IGJlZW4gc3VuayFcIjtcbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgZ2V0U2hpcExlbmd0aCxcbiAgICBnZXRTaGlwSGl0cyxcbiAgICBpc1N1bmssXG4gICAgaGl0LFxuICB9O1xufTtcblxuZXhwb3J0IHsgU2hpcCB9O1xuIiwiaW1wb3J0IHsgR2FtZUxvb3AgfSBmcm9tIFwiLi9nYW1lbG9vcFwiO1xuXG5jb25zdCBET01Db250cm9sbGVyID0gKCgpID0+IHtcbiAgY29uc3QgY3JlYXRlQm9hcmRDZWxscyA9IChnYW1lYm9hcmRET00pID0+IHtcbiAgICBjb25zdCBCT0FSREFYRVNMRU5HVEggPSAxMDtcbiAgICBjb25zdCBjb2x1bW5MYWJlbHMgPSBbXCJBXCIsIFwiQlwiLCBcIkNcIiwgXCJEXCIsIFwiRVwiLCBcIkZcIiwgXCJHXCIsIFwiSFwiLCBcIklcIiwgXCJKXCJdO1xuICAgIGNvbnN0IHJvd0xhYmVscyA9IFtcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiNlwiLCBcIjdcIiwgXCI4XCIsIFwiOVwiLCBcIjEwXCJdO1xuICAgIGNvbnN0IGh1bWFuUGxheWVyT2JqZWN0ID0gR2FtZUxvb3AuZ2V0UGxheWVycygpWzBdO1xuICAgIGZvciAobGV0IGkgPSAtMTsgaSA8IEJPQVJEQVhFU0xFTkdUSDsgaSsrKSB7XG4gICAgICBmb3IgKGxldCBqID0gLTE7IGogPCBCT0FSREFYRVNMRU5HVEg7IGorKykge1xuICAgICAgICBpZiAoaSA9PT0gLTEpIHtcbiAgICAgICAgICBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICAgIGNvbnN0IGludmlzaWJsZVBsYWNlaG9sZGVyRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBpbnZpc2libGVQbGFjZWhvbGRlckVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImdhbWVib2FyZC1sYWJlbFwiKTtcbiAgICAgICAgICAgIGludmlzaWJsZVBsYWNlaG9sZGVyRWxlbWVudC5zdHlsZS52aXNpYmlsaXR5ID0gXCJoaWRkZW5cIjtcbiAgICAgICAgICAgIGdhbWVib2FyZERPTS5hcHBlbmRDaGlsZChpbnZpc2libGVQbGFjZWhvbGRlckVsZW1lbnQpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjb2x1bW5MYWJlbEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgY29sdW1uTGFiZWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJjb2x1bW4tbGFiZWxcIik7XG4gICAgICAgICAgICBjb2x1bW5MYWJlbEVsZW1lbnQudGV4dENvbnRlbnQgPSBjb2x1bW5MYWJlbHNbal07XG4gICAgICAgICAgICBnYW1lYm9hcmRET00uYXBwZW5kQ2hpbGQoY29sdW1uTGFiZWxFbGVtZW50KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAoaiA9PT0gLTEpIHtcbiAgICAgICAgICBjb25zdCByb3dMYWJlbEVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgIHJvd0xhYmVsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwicm93LWxhYmVsXCIpO1xuICAgICAgICAgIHJvd0xhYmVsRWxlbWVudC50ZXh0Q29udGVudCA9IHJvd0xhYmVsc1tpXTtcbiAgICAgICAgICBnYW1lYm9hcmRET00uYXBwZW5kQ2hpbGQocm93TGFiZWxFbGVtZW50KTtcbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICBBcnJheS5mcm9tKGdhbWVib2FyZERPTS5jbGFzc0xpc3QpLmluY2x1ZGVzKFwicGxheWVyLWJvYXJkXCIpXG4gICAgICAgICkge1xuICAgICAgICAgIGNvbnN0IHBsYXllckNlbGxFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgICBwbGF5ZXJDZWxsRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXJvd1wiLCBpKTtcbiAgICAgICAgICBwbGF5ZXJDZWxsRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLWNvbHVtblwiLCBqKTtcbiAgICAgICAgICBwbGF5ZXJDZWxsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZ2FtZWJvYXJkLWNlbGxcIik7XG4gICAgICAgICAgcGxheWVyQ2VsbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImRyYWdvdmVyXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgZHJhZ092ZXIoZXZlbnQpO1xuICAgICAgICAgIH0pO1xuICAgICAgICAgIHBsYXllckNlbGxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaW5zZXJ0RHJhZ2dlZEltYWdlKGV2ZW50KTtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgaHVtYW5QbGF5ZXJPYmplY3QuZ2V0R2FtZWJvYXJkKCkuZ2V0UGxhY2VkU2hpcHMoKS5sZW5ndGggPT09IDVcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICB0b2dnbGVBYmlsaXR5VG9BdHRhY2soXCJlbmFibGVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ2FtZWJvYXJkRE9NLmFwcGVuZENoaWxkKHBsYXllckNlbGxFbGVtZW50KTtcbiAgICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgICBBcnJheS5mcm9tKGdhbWVib2FyZERPTS5jbGFzc0xpc3QpLmluY2x1ZGVzKFwiY29tcHV0ZXItYm9hcmRcIilcbiAgICAgICAgKSB7XG4gICAgICAgICAgY29uc3QgY29tcHV0ZXJDZWxsRWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgICAgY29tcHV0ZXJDZWxsRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkYXRhLXJvd1wiLCBpKTtcbiAgICAgICAgICBjb21wdXRlckNlbGxFbGVtZW50LnNldEF0dHJpYnV0ZShcImRhdGEtY29sdW1uXCIsIGopO1xuICAgICAgICAgIGNvbXB1dGVyQ2VsbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcImdhbWVib2FyZC1jZWxsXCIpO1xuICAgICAgICAgIGNvbXB1dGVyQ2VsbEVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgICAgIGNvbXB1dGVyQ2VsbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgICAgIGlmICghR2FtZUxvb3AuaXNNaWRBdHRhY2soKSkge1xuICAgICAgICAgICAgICBjb25zdCBjZWxsUm93ID0gTnVtYmVyKGNvbXB1dGVyQ2VsbEVsZW1lbnQuZGF0YXNldC5yb3cpO1xuICAgICAgICAgICAgICBjb25zdCBjZWxsQ29sdW1uID0gTnVtYmVyKGNvbXB1dGVyQ2VsbEVsZW1lbnQuZGF0YXNldC5jb2x1bW4pO1xuICAgICAgICAgICAgICBodW1hblBsYXllck9iamVjdC5zZW5kQXR0YWNrKFtjZWxsUm93LCBjZWxsQ29sdW1uXSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgZ2FtZWJvYXJkRE9NLmFwcGVuZENoaWxkKGNvbXB1dGVyQ2VsbEVsZW1lbnQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCB0b2dnbGVBYmlsaXR5VG9BdHRhY2sgPSAoYWN0aW9uKSA9PiB7XG4gICAgY29uc3QgY29tcHV0ZXJHYW1lYm9hcmRFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wdXRlci1ib2FyZFwiKTtcbiAgICBjb25zdCBjZWxsRWxlbWVudHMgPSBBcnJheS5mcm9tKFxuICAgICAgY29tcHV0ZXJHYW1lYm9hcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuZ2FtZWJvYXJkLWNlbGxcIilcbiAgICApO1xuICAgIGlmIChhY3Rpb24gPT09IFwiZW5hYmxlXCIpIHtcbiAgICAgIGNlbGxFbGVtZW50cy5mb3JFYWNoKChjZWxsRWxlbWVudCkgPT4ge1xuICAgICAgICBjZWxsRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSBlbHNlIGlmIChhY3Rpb24gPT09IFwiZGlzYWJsZVwiKSB7XG4gICAgICBjZWxsRWxlbWVudHMuZm9yRWFjaCgoY2VsbEVsZW1lbnQpID0+IHtcbiAgICAgICAgY2VsbEVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuICBjb25zdCBnZXREcmFnZ2VkSW1hZ2UgPSAoZXZlbnQpID0+IHtcbiAgICBjb25zdCBkYXRhT2JqZWN0ID0ge1xuICAgICAgaW1hZ2U6IGV2ZW50LnRhcmdldC5zcmMsXG4gICAgICBzaGlwTGVuZ3RoOiBldmVudC50YXJnZXQuZGF0YXNldC5zaGlwTGVuZ3RoLFxuICAgICAgaG9yaXpvbnRhbDogZmFsc2UsXG4gICAgICB2ZXJ0aWNhbDogZmFsc2UsXG4gICAgICBlbGVtZW50SUQ6IGV2ZW50LnRhcmdldC5nZXRBdHRyaWJ1dGUoXCJpZFwiKSxcbiAgICB9O1xuICAgIGlmIChBcnJheS5mcm9tKGV2ZW50LnRhcmdldC5jbGFzc0xpc3QpLmluY2x1ZGVzKFwiaG9yaXpvbnRhbFwiKSkge1xuICAgICAgZGF0YU9iamVjdC5ob3Jpem9udGFsID0gdHJ1ZTtcbiAgICB9IGVsc2UgaWYgKEFycmF5LmZyb20oZXZlbnQudGFyZ2V0LmNsYXNzTGlzdCkuaW5jbHVkZXMoXCJ2ZXJ0aWNhbFwiKSkge1xuICAgICAgZGF0YU9iamVjdC52ZXJ0aWNhbCA9IHRydWU7XG4gICAgfVxuICAgIGNvbnN0IGRhdGFTdHJpbmcgPSBKU09OLnN0cmluZ2lmeShkYXRhT2JqZWN0KTtcbiAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RGF0YShcImltYWdlXCIsIGRhdGFTdHJpbmcpO1xuICB9O1xuICBjb25zdCBkcmFnT3ZlciA9IChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gIH07XG4gIGNvbnN0IGluaXRpYWxpemVCb2FyZERPTSA9ICgpID0+IHtcbiAgICBjb25zdCBodW1hblBsYXllckdhbWVib2FyZERPTSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheWVyLWJvYXJkXCIpO1xuICAgIGNvbnN0IGNvbXB1dGVyR2FtZWJvYXJkRE9NID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jb21wdXRlci1ib2FyZFwiKTtcbiAgICBjcmVhdGVCb2FyZENlbGxzKGh1bWFuUGxheWVyR2FtZWJvYXJkRE9NKTtcbiAgICBjcmVhdGVCb2FyZENlbGxzKGNvbXB1dGVyR2FtZWJvYXJkRE9NKTtcbiAgfTtcbiAgY29uc3QgaXNWYWxpZEdhbWVib2FyZENlbGwgPSAodGFyZ2V0Q2VsbCwgZGF0YU9iamVjdCkgPT4ge1xuICAgIGNvbnN0IGNlbGxDb29yZGluYXRlcyA9IFtcbiAgICAgIE51bWJlcih0YXJnZXRDZWxsLmRhdGFzZXQucm93KSxcbiAgICAgIE51bWJlcih0YXJnZXRDZWxsLmRhdGFzZXQuY29sdW1uKSxcbiAgICBdO1xuICAgIGNvbnN0IGxlbmd0aCA9IE51bWJlcihkYXRhT2JqZWN0LnNoaXBMZW5ndGgpO1xuICAgIGlmIChkYXRhT2JqZWN0Lmhvcml6b250YWwpIHtcbiAgICAgIGlmIChcbiAgICAgICAgR2FtZUxvb3AuZ2V0UGxheWVycygpWzBdLmNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMoXG4gICAgICAgICAgY2VsbENvb3JkaW5hdGVzLFxuICAgICAgICAgIGxlbmd0aCxcbiAgICAgICAgICBcInJpZ2h0XCJcbiAgICAgICAgKVxuICAgICAgKSB7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoZGF0YU9iamVjdC52ZXJ0aWNhbCkge1xuICAgICAgaWYgKFxuICAgICAgICBHYW1lTG9vcC5nZXRQbGF5ZXJzKClbMF0uY2hlY2tJZlZhbGlkRW1wdHlDb29yZGluYXRlcyhcbiAgICAgICAgICBjZWxsQ29vcmRpbmF0ZXMsXG4gICAgICAgICAgbGVuZ3RoLFxuICAgICAgICAgIFwiZG93blwiXG4gICAgICAgIClcbiAgICAgICkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IGFkZFNoaXBUb0RPTSA9ICh0YXJnZXRDZWxsLCBkYXRhT2JqZWN0KSA9PiB7XG4gICAgY29uc3QgbGVuZ3RoID0gZGF0YU9iamVjdC5zaGlwTGVuZ3RoO1xuICAgIGNvbnN0IHRhcmdldENlbGxSb3cgPSBOdW1iZXIodGFyZ2V0Q2VsbC5kYXRhc2V0LnJvdyk7XG4gICAgY29uc3QgdGFyZ2V0Q2VsbENvbHVtbiA9IE51bWJlcih0YXJnZXRDZWxsLmRhdGFzZXQuY29sdW1uKTtcbiAgICBjb25zdCBjb29yZGluYXRlc0FycmF5ID0gW1t0YXJnZXRDZWxsUm93LCB0YXJnZXRDZWxsQ29sdW1uXV07XG4gICAgdGFyZ2V0Q2VsbC5jbGFzc0xpc3QuYWRkKFwiY29udGFpbnMtc2hpcC1pbWFnZVwiKTtcbiAgICB0YXJnZXRDZWxsLmNsYXNzTGlzdC5hZGQoXCJzaGlwLWltYWdlXCIpO1xuICAgIHRhcmdldENlbGwuY2xhc3NMaXN0LmFkZChgc2hpcC1pbWFnZS0ke2xlbmd0aH1gKTtcbiAgICB0YXJnZXRDZWxsLmNsYXNzTGlzdC5hZGQoYHNoaXAtaW1hZ2UtJHtsZW5ndGh9LTFgKTtcbiAgICBpZiAoZGF0YU9iamVjdC5ob3Jpem9udGFsKSB7XG4gICAgICB0YXJnZXRDZWxsLmNsYXNzTGlzdC5hZGQoXCJob3Jpem9udGFsXCIpO1xuICAgIH0gZWxzZSBpZiAoZGF0YU9iamVjdC52ZXJ0aWNhbCkge1xuICAgICAgdGFyZ2V0Q2VsbC5jbGFzc0xpc3QuYWRkKFwidmVydGljYWxcIik7XG4gICAgfVxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCByZW1haW5pbmdDZWxsO1xuICAgICAgaWYgKGRhdGFPYmplY3QuaG9yaXpvbnRhbCkge1xuICAgICAgICByZW1haW5pbmdDZWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICBgLnBsYXllci1ib2FyZCBbZGF0YS1yb3c9JyR7dGFyZ2V0Q2VsbFJvd30nXVtkYXRhLWNvbHVtbj0nJHtcbiAgICAgICAgICAgIHRhcmdldENlbGxDb2x1bW4gKyBpXG4gICAgICAgICAgfSddYFxuICAgICAgICApO1xuICAgICAgICByZW1haW5pbmdDZWxsLmNsYXNzTGlzdC5hZGQoXCJob3Jpem9udGFsXCIpO1xuICAgICAgICBjb29yZGluYXRlc0FycmF5LnB1c2goW3RhcmdldENlbGxSb3csIHRhcmdldENlbGxDb2x1bW4gKyBpXSk7XG4gICAgICB9IGVsc2UgaWYgKGRhdGFPYmplY3QudmVydGljYWwpIHtcbiAgICAgICAgcmVtYWluaW5nQ2VsbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgYC5wbGF5ZXItYm9hcmQgW2RhdGEtcm93PScke1xuICAgICAgICAgICAgdGFyZ2V0Q2VsbFJvdyArIGlcbiAgICAgICAgICB9J11bZGF0YS1jb2x1bW49JyR7dGFyZ2V0Q2VsbENvbHVtbn0nXWBcbiAgICAgICAgKTtcbiAgICAgICAgcmVtYWluaW5nQ2VsbC5jbGFzc0xpc3QuYWRkKFwidmVydGljYWxcIik7XG4gICAgICAgIGNvb3JkaW5hdGVzQXJyYXkucHVzaChbdGFyZ2V0Q2VsbFJvdyArIGksIHRhcmdldENlbGxDb2x1bW5dKTtcbiAgICAgIH1cbiAgICAgIHJlbWFpbmluZ0NlbGwuY2xhc3NMaXN0LmFkZChcImNvbnRhaW5zLXNoaXAtaW1hZ2VcIik7XG4gICAgICByZW1haW5pbmdDZWxsLmNsYXNzTGlzdC5hZGQoXCJzaGlwLWltYWdlXCIpO1xuICAgICAgcmVtYWluaW5nQ2VsbC5jbGFzc0xpc3QuYWRkKGBzaGlwLWltYWdlLSR7bGVuZ3RofWApO1xuICAgICAgcmVtYWluaW5nQ2VsbC5jbGFzc0xpc3QuYWRkKGBzaGlwLWltYWdlLSR7bGVuZ3RofS0ke2kgKyAxfWApO1xuICAgIH1cbiAgICByZXR1cm4gY29vcmRpbmF0ZXNBcnJheTtcbiAgfTtcbiAgY29uc3QgZGlzYWJsZUltYWdlQnV0dG9uSW50ZXJhY3Rpb25zID0gKGRhdGFPYmplY3QpID0+IHtcbiAgICBjb25zdCBJRCA9IGRhdGFPYmplY3QuZWxlbWVudElEO1xuICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYCMke0lEfWApO1xuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBpbWFnZUVsZW1lbnQucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uXCIpO1xuICAgIGltYWdlRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkcmFnZ2FibGVcIiwgZmFsc2UpO1xuICAgIGltYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwiZGlzYWJsZWQtaW1hZ2VcIik7XG4gICAgYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XG4gIH07XG4gIGNvbnN0IGNyZWF0ZUVycm9yTWVzc2FnZSA9ICgpID0+IHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcbiAgICBlcnJvck1lc3NhZ2UudGV4dENvbnRlbnQgPSBcIlRoYXQgaXMgYW4gaW52YWxpZCBwb3NpdGlvbi5cIjtcbiAgICBlcnJvck1lc3NhZ2UuY2xhc3NMaXN0LmFkZChcImVycm9yLW1lc3NhZ2VcIik7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlcnJvck1lc3NhZ2UpO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChlcnJvck1lc3NhZ2UpO1xuICAgIH0sIDI1MDApO1xuICB9O1xuICBjb25zdCBpbnNlcnREcmFnZ2VkSW1hZ2UgPSAoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0IGh1bWFuUGxheWVyT2JqZWN0ID0gR2FtZUxvb3AuZ2V0UGxheWVycygpWzBdO1xuICAgIGNvbnN0IHRhcmdldENlbGwgPSBldmVudC50YXJnZXQ7XG4gICAgaWYgKEFycmF5LmZyb20odGFyZ2V0Q2VsbC5jbGFzc0xpc3QpLmluY2x1ZGVzKFwiY29udGFpbnMtc2hpcC1pbWFnZVwiKSkge1xuICAgICAgY3JlYXRlRXJyb3JNZXNzYWdlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGRhdGFTdHJpbmcgPSBldmVudC5kYXRhVHJhbnNmZXIuZ2V0RGF0YShcImltYWdlXCIpO1xuICAgIGNvbnN0IGRhdGFPYmplY3QgPSBKU09OLnBhcnNlKGRhdGFTdHJpbmcpO1xuICAgIGlmICghaXNWYWxpZEdhbWVib2FyZENlbGwodGFyZ2V0Q2VsbCwgZGF0YU9iamVjdCkpIHtcbiAgICAgIGNyZWF0ZUVycm9yTWVzc2FnZSgpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBzaGlwQ29vcmRpbmF0ZXMgPSBhZGRTaGlwVG9ET00odGFyZ2V0Q2VsbCwgZGF0YU9iamVjdCk7XG4gICAgaHVtYW5QbGF5ZXJPYmplY3QuYWRkU2hpcFRvR2FtZWJvYXJkKFxuICAgICAgTnVtYmVyKGRhdGFPYmplY3Quc2hpcExlbmd0aCksXG4gICAgICBzaGlwQ29vcmRpbmF0ZXNcbiAgICApO1xuICAgIGRpc2FibGVJbWFnZUJ1dHRvbkludGVyYWN0aW9ucyhkYXRhT2JqZWN0KTtcbiAgICB0YXJnZXRDZWxsLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJkcm9wXCIsIGluc2VydERyYWdnZWRJbWFnZSk7XG4gIH07XG4gIGNvbnN0IHJvdGF0ZVNoaXBJbWFnZSA9IChpbWFnZSkgPT4ge1xuICAgIGNvbnN0IGltYWdlQ2xhc3NlcyA9IEFycmF5LmZyb20oaW1hZ2UuY2xhc3NMaXN0KTtcbiAgICBpZiAoaW1hZ2VDbGFzc2VzLmluY2x1ZGVzKFwiaG9yaXpvbnRhbFwiKSkge1xuICAgICAgaW1hZ2UuY2xhc3NMaXN0LnJlbW92ZShcImhvcml6b250YWxcIik7XG4gICAgICBpbWFnZS5jbGFzc0xpc3QuYWRkKFwidmVydGljYWxcIik7XG4gICAgfSBlbHNlIGlmIChpbWFnZUNsYXNzZXMuaW5jbHVkZXMoXCJ2ZXJ0aWNhbFwiKSkge1xuICAgICAgaW1hZ2UuY2xhc3NMaXN0LnJlbW92ZShcInZlcnRpY2FsXCIpO1xuICAgICAgaW1hZ2UuY2xhc3NMaXN0LmFkZChcImhvcml6b250YWxcIik7XG4gICAgfVxuICB9O1xuICBjb25zdCByb3RhdGVQZXJMZW5ndGggPSAodGVtcERpdiwgY2xvbmVkSW1hZ2VFbGVtZW50KSA9PiB7XG4gICAgY29uc3QgY2xvbmVkSW1hZ2VFbGVtZW50Q2xhc3NlcyA9IEFycmF5LmZyb20oY2xvbmVkSW1hZ2VFbGVtZW50LmNsYXNzTGlzdCk7XG4gICAgaWYgKGNsb25lZEltYWdlRWxlbWVudENsYXNzZXMuaW5jbHVkZXMoXCJob3Jpem9udGFsXCIpKSB7XG4gICAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZS1ob3Jpem9udGFsXCIpO1xuICAgIH0gZWxzZSBpZiAoY2xvbmVkSW1hZ2VFbGVtZW50Q2xhc3Nlcy5pbmNsdWRlcyhcInZlcnRpY2FsXCIpKSB7XG4gICAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZS12ZXJ0aWNhbFwiKTtcbiAgICAgIGlmIChjbG9uZWRJbWFnZUVsZW1lbnQuZGF0YXNldC5zaGlwTGVuZ3RoID09PSBcIjVcIikge1xuICAgICAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZS12ZXJ0aWNhbC01XCIpO1xuICAgICAgfSBlbHNlIGlmIChjbG9uZWRJbWFnZUVsZW1lbnQuZGF0YXNldC5zaGlwTGVuZ3RoID09PSBcIjRcIikge1xuICAgICAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZS12ZXJ0aWNhbC00XCIpO1xuICAgICAgfSBlbHNlIGlmIChjbG9uZWRJbWFnZUVsZW1lbnQuZGF0YXNldC5zaGlwTGVuZ3RoID09PSBcIjNcIikge1xuICAgICAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZS12ZXJ0aWNhbC0zXCIpO1xuICAgICAgfSBlbHNlIGlmIChjbG9uZWRJbWFnZUVsZW1lbnQuZGF0YXNldC5zaGlwTGVuZ3RoID09PSBcIjJcIikge1xuICAgICAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZS12ZXJ0aWNhbC0yXCIpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3Qgcm90YXRlRHJhZ2dlZEltYWdlID0gKGV2ZW50KSA9PiB7XG4gICAgY29uc3QgaW1hZ2VFbGVtZW50ID0gZXZlbnQudGFyZ2V0O1xuICAgIGNvbnN0IGNsb25lZEltYWdlRWxlbWVudCA9IGltYWdlRWxlbWVudC5jbG9uZU5vZGUoKTtcbiAgICBjb25zdCB0ZW1wRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICB0ZW1wRGl2LmNsYXNzTGlzdC5hZGQoXCJ0ZW1wLXJvdGF0ZVwiKTtcbiAgICByb3RhdGVQZXJMZW5ndGgodGVtcERpdiwgY2xvbmVkSW1hZ2VFbGVtZW50KTtcbiAgICB0ZW1wRGl2LmFwcGVuZENoaWxkKGNsb25lZEltYWdlRWxlbWVudCk7XG4gICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZCh0ZW1wRGl2KTtcbiAgICBldmVudC5kYXRhVHJhbnNmZXIuc2V0RHJhZ0ltYWdlKHRlbXBEaXYsIDAsIDApO1xuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZCh0ZW1wRGl2KTtcbiAgICB9LCAwKTtcbiAgfTtcbiAgY29uc3QgYWRkQXR0YWNrUmVzdWx0RE9NID0gKHBsYXllclR5cGUsIGF0dGFja1Jlc3VsdHMsIGNvb3JkaW5hdGVzKSA9PiB7XG4gICAgY29uc3QgY2VsbFJvdyA9IGNvb3JkaW5hdGVzWzBdO1xuICAgIGNvbnN0IGNlbGxDb2x1bW4gPSBjb29yZGluYXRlc1sxXTtcbiAgICBjb25zdCBnYW1lYm9hcmRET00gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAuJHtwbGF5ZXJUeXBlfS1ib2FyZGApO1xuICAgIGNvbnN0IHRhcmdldENlbGwgPSBnYW1lYm9hcmRET00ucXVlcnlTZWxlY3RvcihcbiAgICAgIGBbZGF0YS1yb3c9JyR7Y2VsbFJvd30nXVtkYXRhLWNvbHVtbj0nJHtjZWxsQ29sdW1ufSddYFxuICAgICk7XG4gICAgY29uc3QgYXR0YWNrUmVzdWx0c0VsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW1nXCIpO1xuICAgIGF0dGFja1Jlc3VsdHNFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJhdHRhY2stcmVzdWx0c1wiKTtcbiAgICB0YXJnZXRDZWxsLmFwcGVuZENoaWxkKGF0dGFja1Jlc3VsdHNFbGVtZW50KTtcbiAgICBpZiAoYXR0YWNrUmVzdWx0cyA9PT0gXCJoaXRcIikge1xuICAgICAgYXR0YWNrUmVzdWx0c0VsZW1lbnQuc2V0QXR0cmlidXRlKFwic3JjXCIsIFwiLi4vZGlzdC9yZWRfWC5wbmdcIik7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF0dGFja1Jlc3VsdHNFbGVtZW50LnNldEF0dHJpYnV0ZShcInNyY1wiLCBcIi4uL2Rpc3Qvd2hpdGVfTy5wbmdcIik7XG4gICAgfVxuICAgIHRhcmdldENlbGwuZGlzYWJsZWQgPSB0cnVlO1xuICB9O1xuICBjb25zdCBkaXNwbGF5V2lubmVyID0gKHdpbm5pbmdQbGF5ZXIpID0+IHtcbiAgICBjb25zdCBwbGF5ZXJUeXBlID0gd2lubmluZ1BsYXllci5pc0NvbXB1dGVyKCk7XG4gICAgY29uc3QgZ2FtZVJlc3VsdHNFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lLXJlc3VsdHNcIik7XG4gICAgZ2FtZVJlc3VsdHNFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJkZWZhdWx0LWhpZGRlblwiKTtcbiAgICBjb25zdCBkaXNwbGF5V2lubmVyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZGlzcGxheS13aW5uZXJcIik7XG4gICAgaWYgKCFwbGF5ZXJUeXBlKSB7XG4gICAgICBkaXNwbGF5V2lubmVyRWxlbWVudC50ZXh0Q29udGVudCA9IFwiQ29uZ3JhdHVsYXRpb25zLCB5b3Ugd29uIVwiO1xuICAgIH0gZWxzZSB7XG4gICAgICBkaXNwbGF5V2lubmVyRWxlbWVudC50ZXh0Q29udGVudCA9IFwiT2ggbm8sIHlvdSBsb3N0ISBUcnkgYWdhaW4hXCI7XG4gICAgfVxuICB9O1xuICBjb25zdCByZXNldEdhbWVib2FyZHMgPSAoKSA9PiB7XG4gICAgY29uc3QgcGxheWVyR2FtZWJvYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wbGF5ZXItYm9hcmRcIik7XG4gICAgcGxheWVyR2FtZWJvYXJkLmlubmVySFRNTCA9IFwiXCI7XG4gICAgY29uc3QgY29tcHV0ZXJHYW1lYm9hcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLmNvbXB1dGVyLWJvYXJkXCIpO1xuICAgIGNvbXB1dGVyR2FtZWJvYXJkLmlubmVySFRNTCA9IFwiXCI7XG4gIH07XG4gIGNvbnN0IHJlc2V0U2hpcEltYWdlcyA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwUGllY2VJbWFnZXMgPSBBcnJheS5mcm9tKFxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5zaGlwLXBpZWNlXCIpXG4gICAgKTtcbiAgICBzaGlwUGllY2VJbWFnZXMuZm9yRWFjaCgoaW1hZ2UpID0+IHtcbiAgICAgIGltYWdlLnNldEF0dHJpYnV0ZShcImRyYWdnYWJsZVwiLCB0cnVlKTtcbiAgICAgIGltYWdlLmNsYXNzTGlzdC5yZW1vdmUoXCJkaXNhYmxlZC1pbWFnZVwiKTtcbiAgICAgIGlmIChBcnJheS5mcm9tKGltYWdlLmNsYXNzTGlzdCkuaW5jbHVkZXMoXCJ2ZXJ0aWNhbFwiKSkge1xuICAgICAgICBpbWFnZS5jbGFzc0xpc3QucmVtb3ZlKFwidmVydGljYWxcIik7XG4gICAgICAgIGltYWdlLmNsYXNzTGlzdC5hZGQoXCJob3Jpem9udGFsXCIpO1xuICAgICAgfVxuICAgIH0pO1xuICB9O1xuICBjb25zdCByZXNldFJvdGF0ZVNoaXBCdXR0b25zID0gKCkgPT4ge1xuICAgIGNvbnN0IHJvdGF0ZVNoaXBCdXR0b25zID0gQXJyYXkuZnJvbShcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIucm90YXRlLXNoaXBcIilcbiAgICApO1xuICAgIHJvdGF0ZVNoaXBCdXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4ge1xuICAgICAgYnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IHJlc2V0R2FtZVJlc3VsdHMgPSAoKSA9PiB7XG4gICAgY29uc3QgZ2FtZVJlc3VsdHNFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYW1lLXJlc3VsdHNcIik7XG4gICAgZ2FtZVJlc3VsdHNFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJkZWZhdWx0LWhpZGRlblwiKTtcbiAgICBjb25zdCBkaXNwbGF5V2lubmVyRWxlbWVudCA9XG4gICAgICBnYW1lUmVzdWx0c0VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5kaXNwbGF5LXdpbm5lclwiKTtcbiAgICBkaXNwbGF5V2lubmVyRWxlbWVudC50ZXh0Q29udGVudCA9IFwiUGxhY2Vob2xkZXJcIjtcbiAgfTtcbiAgY29uc3QgcmVzZXRET00gPSAoKSA9PiB7XG4gICAgcmVzZXRHYW1lYm9hcmRzKCk7XG4gICAgcmVzZXRTaGlwSW1hZ2VzKCk7XG4gICAgcmVzZXRSb3RhdGVTaGlwQnV0dG9ucygpO1xuICAgIHJlc2V0R2FtZVJlc3VsdHMoKTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBpbml0aWFsaXplQm9hcmRET00sXG4gICAgaW5zZXJ0RHJhZ2dlZEltYWdlLFxuICAgIHJvdGF0ZVNoaXBJbWFnZSxcbiAgICByb3RhdGVEcmFnZ2VkSW1hZ2UsXG4gICAgZ2V0RHJhZ2dlZEltYWdlLFxuICAgIGRyYWdPdmVyLFxuICAgIGFkZEF0dGFja1Jlc3VsdERPTSxcbiAgICB0b2dnbGVBYmlsaXR5VG9BdHRhY2ssXG4gICAgZGlzcGxheVdpbm5lcixcbiAgICByZXNldERPTSxcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCB7IERPTUNvbnRyb2xsZXIgfTtcbiIsImltcG9ydCB7IFNoaXAgfSBmcm9tIFwiLi9zaGlwXCI7XG5pbXBvcnQgeyBHYW1lYm9hcmQgfSBmcm9tIFwiLi9nYW1lYm9hcmRcIjtcbmltcG9ydCB7IEdhbWVMb29wIH0gZnJvbSBcIi4vZ2FtZWxvb3BcIjtcbmltcG9ydCB7IERPTUNvbnRyb2xsZXIgfSBmcm9tIFwiLi9ET01fY29udHJvbGxlclwiO1xuXG5jb25zdCBQbGF5ZXIgPSAocGxheWVyVHlwZSkgPT4ge1xuICBjb25zdCBkZXRlcm1pbmVQbGF5ZXJUeXBlID0gKCkgPT4ge1xuICAgIGlmIChwbGF5ZXJUeXBlID09PSBcImh1bWFuXCIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBsYXllclR5cGUgPT09IFwiY29tcHV0ZXJcIikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9O1xuICBjb25zdCBjb21wdXRlclBsYXllciA9IGRldGVybWluZVBsYXllclR5cGUoKTtcbiAgY29uc3QgcGxheWVyR2FtZWJvYXJkID0gR2FtZWJvYXJkKCk7XG4gIGxldCBvcHBvc2luZ1BsYXllcjtcbiAgY29uc3QgaXNDb21wdXRlciA9ICgpID0+IGNvbXB1dGVyUGxheWVyO1xuICBjb25zdCBnZXRHYW1lYm9hcmQgPSAoKSA9PiBwbGF5ZXJHYW1lYm9hcmQ7XG4gIGNvbnN0IGdldE9wcG9zaW5nUGxheWVyID0gKCkgPT4gb3Bwb3NpbmdQbGF5ZXI7XG4gIGNvbnN0IHNldE9wcG9zaW5nUGxheWVyID0gKHBsYXllcikgPT4ge1xuICAgIG9wcG9zaW5nUGxheWVyID0gcGxheWVyO1xuICB9O1xuICBjb25zdCBhZGRTaGlwVG9HYW1lYm9hcmQgPSAoc2hpcExlbmd0aCwgY29vcmRpbmF0ZXMpID0+IHtcbiAgICBjb25zdCBzaGlwID0gU2hpcChzaGlwTGVuZ3RoKTtcbiAgICBwbGF5ZXJHYW1lYm9hcmQucGxhY2VTaGlwKHNoaXAsIGNvb3JkaW5hdGVzKTtcbiAgfTtcbiAgY29uc3Qgc2VuZEF0dGFjayA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGlmIChcbiAgICAgIGNoZWNrSWZQcmV2aW91c2x5QXR0YWNrZWQoY29vcmRpbmF0ZXMpIHx8XG4gICAgICAhR2FtZUxvb3AuaXNJblByb2dyZXNzKCkgfHxcbiAgICAgIEdhbWVMb29wLmlzTWlkQXR0YWNrKClcbiAgICApIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgb3Bwb3NpbmdQbGF5ZXJHYW1lYm9hcmQgPSBvcHBvc2luZ1BsYXllci5nZXRHYW1lYm9hcmQoKTtcbiAgICBjb25zdCBhdHRhY2tSZXN1bHRzID0gb3Bwb3NpbmdQbGF5ZXIucmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcyk7XG4gICAgaWYgKGF0dGFja1Jlc3VsdHMgPT09IFwiaGl0XCIpIHtcbiAgICAgIHBsYXllckdhbWVib2FyZC5hZGRTZW50SGl0U2hvdChjb29yZGluYXRlcyk7XG4gICAgICBpZiAoIWlzQ29tcHV0ZXIoKSkge1xuICAgICAgICBET01Db250cm9sbGVyLmFkZEF0dGFja1Jlc3VsdERPTShcbiAgICAgICAgICBcImNvbXB1dGVyXCIsXG4gICAgICAgICAgYXR0YWNrUmVzdWx0cyxcbiAgICAgICAgICBjb29yZGluYXRlc1xuICAgICAgICApO1xuICAgICAgfSBlbHNlIGlmIChpc0NvbXB1dGVyKCkpIHtcbiAgICAgICAgRE9NQ29udHJvbGxlci5hZGRBdHRhY2tSZXN1bHRET00oXCJwbGF5ZXJcIiwgYXR0YWNrUmVzdWx0cywgY29vcmRpbmF0ZXMpO1xuICAgICAgfVxuICAgICAgaWYgKG9wcG9zaW5nUGxheWVyR2FtZWJvYXJkLmlzQWxsU2hpcHNTdW5rKCkpIHtcbiAgICAgICAgR2FtZUxvb3AuZW5kR2FtZShvcHBvc2luZ1BsYXllcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGF0dGFja1Jlc3VsdHMgPT09IFwibWlzc1wiKSB7XG4gICAgICBwbGF5ZXJHYW1lYm9hcmQuYWRkU2VudE1pc3NlZFNob3QoY29vcmRpbmF0ZXMpO1xuICAgICAgaWYgKCFpc0NvbXB1dGVyKCkpIHtcbiAgICAgICAgRE9NQ29udHJvbGxlci5hZGRBdHRhY2tSZXN1bHRET00oXG4gICAgICAgICAgXCJjb21wdXRlclwiLFxuICAgICAgICAgIGF0dGFja1Jlc3VsdHMsXG4gICAgICAgICAgY29vcmRpbmF0ZXNcbiAgICAgICAgKTtcbiAgICAgIH0gZWxzZSBpZiAoaXNDb21wdXRlcigpKSB7XG4gICAgICAgIERPTUNvbnRyb2xsZXIuYWRkQXR0YWNrUmVzdWx0RE9NKFwicGxheWVyXCIsIGF0dGFja1Jlc3VsdHMsIGNvb3JkaW5hdGVzKTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG9wcG9zaW5nUGxheWVyLmlzQ29tcHV0ZXIoKSkge1xuICAgICAgR2FtZUxvb3AudG9nZ2xlTWlkQXR0YWNrKHRydWUpO1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIEdhbWVMb29wLnRvZ2dsZU1pZEF0dGFjayhmYWxzZSk7XG4gICAgICAgIG9wcG9zaW5nUGxheWVyLnNlbmRDb21wdXRlckF0dGFjaygpO1xuICAgICAgfSwgMCk7XG4gICAgfVxuICB9O1xuICBjb25zdCBpbml0aWFsaXplQ29tcHV0ZXJHYW1lYm9hcmQgPSAoKSA9PiB7XG4gICAgaWYgKCFjb21wdXRlclBsYXllcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBsZW5ndGhzT2ZTaGlwcyA9IFs1LCA0LCAzLCAzLCAyXTtcbiAgICBmb3IgKGNvbnN0IHNoaXBMZW5ndGggb2YgbGVuZ3Roc09mU2hpcHMpIHtcbiAgICAgIGNvbnN0IHNoaXBDb29yZGluYXRlcyA9IGdlbmVyYXRlQ29tcHV0ZXJTaGlwQ29vcmRpbmF0ZXMoc2hpcExlbmd0aCk7XG4gICAgICBhZGRTaGlwVG9HYW1lYm9hcmQoc2hpcExlbmd0aCwgc2hpcENvb3JkaW5hdGVzKTtcbiAgICB9XG4gIH07XG4gIGNvbnN0IHNlbmRDb21wdXRlckF0dGFjayA9ICgpID0+IHtcbiAgICBpZiAoIWNvbXB1dGVyUGxheWVyIHx8ICFHYW1lTG9vcC5pc0luUHJvZ3Jlc3MoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBhdHRhY2tDb29yZGluYXRlcyA9IGdlbmVyYXRlQXR0YWNrQ29vcmRpbmF0ZXMoKTtcbiAgICBzZW5kQXR0YWNrKGF0dGFja0Nvb3JkaW5hdGVzKTtcbiAgfTtcbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGNvbnN0IGF0dGFja1Jlc3VsdHMgPSBwbGF5ZXJHYW1lYm9hcmQucmVjZWl2ZUF0dGFjayhjb29yZGluYXRlcyk7XG4gICAgcmV0dXJuIGF0dGFja1Jlc3VsdHM7XG4gIH07XG4gIGNvbnN0IGdlbmVyYXRlQ29tcHV0ZXJTaGlwQ29vcmRpbmF0ZXMgPSAoc2hpcExlbmd0aCkgPT4ge1xuICAgIGxldCBsaXN0T2ZDb29yZGluYXRlcyA9IFtdO1xuICAgIGRvIHtcbiAgICAgIGxpc3RPZkNvb3JkaW5hdGVzID0gW107XG4gICAgICBjb25zdCBzdGFydGluZ0Nvb3JkaW5hdGVzID0gZ2VuZXJhdGVTdGFydGluZ0Nvb3JkaW5hdGVzKCk7XG4gICAgICBjb25zdCBub25TdGFydGluZ0Nvb3JkaW5hdGVzID0gZ2VuZXJhdGVOb25TdGFydGluZ0Nvb3JkaW5hdGVzKFxuICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzLFxuICAgICAgICBzaGlwTGVuZ3RoXG4gICAgICApO1xuICAgICAgbGlzdE9mQ29vcmRpbmF0ZXMucHVzaChzdGFydGluZ0Nvb3JkaW5hdGVzKTtcbiAgICAgIGxpc3RPZkNvb3JkaW5hdGVzID0gbGlzdE9mQ29vcmRpbmF0ZXMuY29uY2F0KG5vblN0YXJ0aW5nQ29vcmRpbmF0ZXMpO1xuICAgIH0gd2hpbGUgKGxpc3RPZkNvb3JkaW5hdGVzLmxlbmd0aCA8IHNoaXBMZW5ndGgpO1xuICAgIHJldHVybiBsaXN0T2ZDb29yZGluYXRlcztcbiAgfTtcbiAgY29uc3QgZ2VuZXJhdGVTdGFydGluZ0Nvb3JkaW5hdGVzID0gKCkgPT4ge1xuICAgIGNvbnN0IHN0YXJ0aW5nQ29vcmRpbmF0ZXMgPSBbdW5kZWZpbmVkLCB1bmRlZmluZWRdO1xuICAgIGRvIHtcbiAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0gPSBnZW5lcmF0ZVJhbmRvbUNvb3JkaW5hdGUoKTtcbiAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gPSBnZW5lcmF0ZVJhbmRvbUNvb3JkaW5hdGUoKTtcbiAgICB9IHdoaWxlIChwbGF5ZXJHYW1lYm9hcmQuZ2V0Q29vcmRpbmF0ZXMoc3RhcnRpbmdDb29yZGluYXRlcykgIT09IHVuZGVmaW5lZCk7XG4gICAgcmV0dXJuIHN0YXJ0aW5nQ29vcmRpbmF0ZXM7XG4gIH07XG4gIGNvbnN0IGdlbmVyYXRlTm9uU3RhcnRpbmdDb29yZGluYXRlcyA9IChzdGFydGluZ0Nvb3JkaW5hdGVzLCBzaGlwTGVuZ3RoKSA9PiB7XG4gICAgY29uc3QgcG9zc2libGVDb29yZGluYXRlcyA9IFtdO1xuICAgIGlmIChjaGVja0lmVmFsaWRFbXB0eUNvb3JkaW5hdGVzKHN0YXJ0aW5nQ29vcmRpbmF0ZXMsIHNoaXBMZW5ndGgsIFwidXBcIikpIHtcbiAgICAgIGNvbnN0IHVwQ29vcmRpbmF0ZXMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgIHVwQ29vcmRpbmF0ZXMucHVzaChbXG4gICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSAtIGksXG4gICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1sxXSxcbiAgICAgICAgXSk7XG4gICAgICB9XG4gICAgICBwb3NzaWJsZUNvb3JkaW5hdGVzLnB1c2godXBDb29yZGluYXRlcyk7XG4gICAgfVxuICAgIGlmIChcbiAgICAgIGNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMoc3RhcnRpbmdDb29yZGluYXRlcywgc2hpcExlbmd0aCwgXCJyaWdodFwiKVxuICAgICkge1xuICAgICAgY29uc3QgcmlnaHRDb29yZGluYXRlcyA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgcmlnaHRDb29yZGluYXRlcy5wdXNoKFtcbiAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzBdLFxuICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0gKyBpLFxuICAgICAgICBdKTtcbiAgICAgIH1cbiAgICAgIHBvc3NpYmxlQ29vcmRpbmF0ZXMucHVzaChyaWdodENvb3JkaW5hdGVzKTtcbiAgICB9XG4gICAgaWYgKGNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMoc3RhcnRpbmdDb29yZGluYXRlcywgc2hpcExlbmd0aCwgXCJkb3duXCIpKSB7XG4gICAgICBjb25zdCBkb3duQ29vcmRpbmF0ZXMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgIGRvd25Db29yZGluYXRlcy5wdXNoKFtcbiAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzBdICsgaSxcbiAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzFdLFxuICAgICAgICBdKTtcbiAgICAgIH1cbiAgICAgIHBvc3NpYmxlQ29vcmRpbmF0ZXMucHVzaChkb3duQ29vcmRpbmF0ZXMpO1xuICAgIH1cbiAgICBpZiAoY2hlY2tJZlZhbGlkRW1wdHlDb29yZGluYXRlcyhzdGFydGluZ0Nvb3JkaW5hdGVzLCBzaGlwTGVuZ3RoLCBcImxlZnRcIikpIHtcbiAgICAgIGNvbnN0IGxlZnRDb29yZGluYXRlcyA9IFtdO1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGVmdENvb3JkaW5hdGVzLnB1c2goW1xuICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMF0sXG4gICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1sxXSAtIGksXG4gICAgICAgIF0pO1xuICAgICAgfVxuICAgICAgcG9zc2libGVDb29yZGluYXRlcy5wdXNoKGxlZnRDb29yZGluYXRlcyk7XG4gICAgfVxuICAgIGlmIChwb3NzaWJsZUNvb3JkaW5hdGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHBvc3NpYmxlQ29vcmRpbmF0ZXM7XG4gICAgfVxuICAgIGNvbnN0IHJhbmRvbUluZGV4ID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGVDb29yZGluYXRlcy5sZW5ndGgpO1xuICAgIHJldHVybiBwb3NzaWJsZUNvb3JkaW5hdGVzW3JhbmRvbUluZGV4XTtcbiAgfTtcbiAgY29uc3QgZ2VuZXJhdGVSYW5kb21Db29yZGluYXRlID0gKCkgPT4ge1xuICAgIGNvbnN0IEJPQVJEQVhFU0xFTkdUSCA9IDEwO1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBCT0FSREFYRVNMRU5HVEgpO1xuICB9O1xuICBjb25zdCBjaGVja0lmUHJldmlvdXNseUF0dGFja2VkID0gKGF0dGFja0Nvb3JkaW5hdGVzKSA9PiB7XG4gICAgbGV0IHByZXZpb3VzbHlBdHRhY2tlZCA9IGZhbHNlO1xuICAgIGNvbnN0IHJlY2VpdmVkTWlzc2VkU2hvdHMgPSBvcHBvc2luZ1BsYXllclxuICAgICAgLmdldEdhbWVib2FyZCgpXG4gICAgICAuZ2V0UmVjZWl2ZWRNaXNzZWRTaG90cygpO1xuICAgIGNvbnN0IHJlY2VpdmVkSGl0U2hvdHMgPSBvcHBvc2luZ1BsYXllclxuICAgICAgLmdldEdhbWVib2FyZCgpXG4gICAgICAuZ2V0UmVjZWl2ZWRIaXRTaG90cygpO1xuICAgIHByZXZpb3VzbHlBdHRhY2tlZCA9IHJlY2VpdmVkTWlzc2VkU2hvdHMuc29tZShcbiAgICAgIChzaG90KSA9PlxuICAgICAgICBzaG90WzBdID09PSBhdHRhY2tDb29yZGluYXRlc1swXSAmJiBzaG90WzFdID09PSBhdHRhY2tDb29yZGluYXRlc1sxXVxuICAgICk7XG4gICAgaWYgKCFwcmV2aW91c2x5QXR0YWNrZWQpIHtcbiAgICAgIHByZXZpb3VzbHlBdHRhY2tlZCA9IHJlY2VpdmVkSGl0U2hvdHMuc29tZShcbiAgICAgICAgKHNob3QpID0+XG4gICAgICAgICAgc2hvdFswXSA9PT0gYXR0YWNrQ29vcmRpbmF0ZXNbMF0gJiYgc2hvdFsxXSA9PT0gYXR0YWNrQ29vcmRpbmF0ZXNbMV1cbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBwcmV2aW91c2x5QXR0YWNrZWQ7XG4gIH07XG4gIGNvbnN0IGdlbmVyYXRlQXR0YWNrQ29vcmRpbmF0ZXMgPSAoKSA9PiB7XG4gICAgY29uc3QgYXR0YWNrQ29vcmRpbmF0ZXMgPSBbdW5kZWZpbmVkLCB1bmRlZmluZWRdO1xuICAgIGRvIHtcbiAgICAgIGF0dGFja0Nvb3JkaW5hdGVzWzBdID0gZ2VuZXJhdGVSYW5kb21Db29yZGluYXRlKCk7XG4gICAgICBhdHRhY2tDb29yZGluYXRlc1sxXSA9IGdlbmVyYXRlUmFuZG9tQ29vcmRpbmF0ZSgpO1xuICAgIH0gd2hpbGUgKGNoZWNrSWZQcmV2aW91c2x5QXR0YWNrZWQoYXR0YWNrQ29vcmRpbmF0ZXMpKTtcbiAgICByZXR1cm4gYXR0YWNrQ29vcmRpbmF0ZXM7XG4gIH07XG4gIGNvbnN0IGNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMgPSAoXG4gICAgc3RhcnRpbmdDb29yZGluYXRlcyxcbiAgICBzaGlwTGVuZ3RoLFxuICAgIGRpcmVjdGlvblxuICApID0+IHtcbiAgICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgICAgY2FzZSBcInVwXCI6XG4gICAgICAgIGlmIChzdGFydGluZ0Nvb3JkaW5hdGVzWzBdIC0gKHNoaXBMZW5ndGggLSAxKSA8IDApIHtcbiAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBzaGlwTGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBwbGF5ZXJHYW1lYm9hcmQuZ2V0Q29vcmRpbmF0ZXMoW1xuICAgICAgICAgICAgICBzdGFydGluZ0Nvb3JkaW5hdGVzWzBdIC0gaSxcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1sxXSxcbiAgICAgICAgICAgIF0pICE9PSB1bmRlZmluZWRcbiAgICAgICAgICApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG5cbiAgICAgIGNhc2UgXCJyaWdodFwiOlxuICAgICAgICBpZiAoc3RhcnRpbmdDb29yZGluYXRlc1sxXSArIChzaGlwTGVuZ3RoIC0gMSkgPiA5KSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgcGxheWVyR2FtZWJvYXJkLmdldENvb3JkaW5hdGVzKFtcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSxcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1sxXSArIGksXG4gICAgICAgICAgICBdKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBjYXNlIFwiZG93blwiOlxuICAgICAgICBpZiAoc3RhcnRpbmdDb29yZGluYXRlc1swXSArIChzaGlwTGVuZ3RoIC0gMSkgPiA5KSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgcGxheWVyR2FtZWJvYXJkLmdldENvb3JkaW5hdGVzKFtcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSArIGksXG4gICAgICAgICAgICAgIHN0YXJ0aW5nQ29vcmRpbmF0ZXNbMV0sXG4gICAgICAgICAgICBdKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBjYXNlIFwibGVmdFwiOlxuICAgICAgICBpZiAoc3RhcnRpbmdDb29yZGluYXRlc1sxXSAtIChzaGlwTGVuZ3RoIC0gMSkgPCAwKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIGZvciAobGV0IGkgPSAxOyBpIDwgc2hpcExlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgaWYgKFxuICAgICAgICAgICAgcGxheWVyR2FtZWJvYXJkLmdldENvb3JkaW5hdGVzKFtcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1swXSxcbiAgICAgICAgICAgICAgc3RhcnRpbmdDb29yZGluYXRlc1sxXSAtIGksXG4gICAgICAgICAgICBdKSAhPT0gdW5kZWZpbmVkXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgaXNDb21wdXRlcixcbiAgICBnZXRHYW1lYm9hcmQsXG4gICAgZ2V0T3Bwb3NpbmdQbGF5ZXIsXG4gICAgc2V0T3Bwb3NpbmdQbGF5ZXIsXG4gICAgYWRkU2hpcFRvR2FtZWJvYXJkLFxuICAgIHNlbmRBdHRhY2ssXG4gICAgaW5pdGlhbGl6ZUNvbXB1dGVyR2FtZWJvYXJkLFxuICAgIHNlbmRDb21wdXRlckF0dGFjayxcbiAgICByZWNlaXZlQXR0YWNrLFxuICAgIGNoZWNrSWZWYWxpZEVtcHR5Q29vcmRpbmF0ZXMsXG4gIH07XG59O1xuXG5leHBvcnQgeyBQbGF5ZXIgfTtcbiIsImNvbnN0IEdhbWVib2FyZCA9ICgpID0+IHtcbiAgY29uc3QgY3JlYXRlQm9hcmQgPSAoKSA9PiB7XG4gICAgY29uc3QgYm9hcmQgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgIGJvYXJkLnB1c2goW10pO1xuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCAxMDsgaisrKSB7XG4gICAgICAgIGJvYXJkW2ldLnB1c2godW5kZWZpbmVkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGJvYXJkO1xuICB9O1xuICBjb25zdCBib2FyZCA9IGNyZWF0ZUJvYXJkKCk7XG4gIGNvbnN0IHBsYWNlZFNoaXBzID0gW107XG4gIGNvbnN0IHJlY2VpdmVkTWlzc2VkU2hvdHMgPSBbXTtcbiAgY29uc3QgcmVjZWl2ZWRIaXRTaG90cyA9IFtdO1xuICBjb25zdCBzZW50TWlzc2VkU2hvdHMgPSBbXTtcbiAgY29uc3Qgc2VudEhpdFNob3RzID0gW107XG4gIGxldCBhbGxTaGlwc1N1bmsgPSBmYWxzZTtcbiAgY29uc3QgZ2V0Q29vcmRpbmF0ZXMgPSAoY29vcmRpbmF0ZXMpID0+IGJvYXJkW2Nvb3JkaW5hdGVzWzBdXVtjb29yZGluYXRlc1sxXV07XG4gIGNvbnN0IGdldFBsYWNlZFNoaXBzID0gKCkgPT4gcGxhY2VkU2hpcHM7XG4gIGNvbnN0IGdldFJlY2VpdmVkTWlzc2VkU2hvdHMgPSAoKSA9PiByZWNlaXZlZE1pc3NlZFNob3RzO1xuICBjb25zdCBnZXRSZWNlaXZlZEhpdFNob3RzID0gKCkgPT4gcmVjZWl2ZWRIaXRTaG90cztcbiAgY29uc3QgZ2V0U2VudE1pc3NlZFNob3RzID0gKCkgPT4gc2VudE1pc3NlZFNob3RzO1xuICBjb25zdCBnZXRTZW50SGl0U2hvdHMgPSAoKSA9PiBzZW50SGl0U2hvdHM7XG4gIGNvbnN0IGlzQWxsU2hpcHNTdW5rID0gKCkgPT4gYWxsU2hpcHNTdW5rO1xuICBjb25zdCBwbGFjZVNoaXAgPSAoc2hpcCwgY29vcmRpbmF0ZXNMaXN0KSA9PiB7XG4gICAgZm9yIChjb25zdCBjb29yZGluYXRlcyBvZiBjb29yZGluYXRlc0xpc3QpIHtcbiAgICAgIGJvYXJkW2Nvb3JkaW5hdGVzWzBdXVtjb29yZGluYXRlc1sxXV0gPSBzaGlwO1xuICAgIH1cbiAgICBwbGFjZWRTaGlwcy5wdXNoKHNoaXApO1xuICB9O1xuICBjb25zdCBjaGVja0FsbFNoaXBzU3VuayA9ICgpID0+IHtcbiAgICBpZiAocGxhY2VkU2hpcHMuZXZlcnkoKHNoaXApID0+IHNoaXAuaXNTdW5rKCkpKSB7XG4gICAgICBhbGxTaGlwc1N1bmsgPSB0cnVlO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgcmVjZWl2ZUF0dGFjayA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIGNvbnN0IGVudGl0eUF0Q29vcmRpbmF0ZXMgPSBnZXRDb29yZGluYXRlcyhjb29yZGluYXRlcyk7XG4gICAgaWYgKGVudGl0eUF0Q29vcmRpbmF0ZXMgIT09IHVuZGVmaW5lZCkge1xuICAgICAgZW50aXR5QXRDb29yZGluYXRlcy5oaXQoKTtcbiAgICAgIGNoZWNrQWxsU2hpcHNTdW5rKCk7XG4gICAgICByZWNlaXZlZEhpdFNob3RzLnB1c2goY29vcmRpbmF0ZXMpO1xuICAgICAgcmV0dXJuIFwiaGl0XCI7XG4gICAgfVxuICAgIHJlY2VpdmVkTWlzc2VkU2hvdHMucHVzaChjb29yZGluYXRlcyk7XG4gICAgcmV0dXJuIFwibWlzc1wiO1xuICB9O1xuICBjb25zdCBhZGRTZW50TWlzc2VkU2hvdCA9IChjb29yZGluYXRlcykgPT4ge1xuICAgIHNlbnRNaXNzZWRTaG90cy5wdXNoKGNvb3JkaW5hdGVzKTtcbiAgfTtcbiAgY29uc3QgYWRkU2VudEhpdFNob3QgPSAoY29vcmRpbmF0ZXMpID0+IHtcbiAgICBzZW50SGl0U2hvdHMucHVzaChjb29yZGluYXRlcyk7XG4gIH07XG4gIHJldHVybiB7XG4gICAgZ2V0Q29vcmRpbmF0ZXMsXG4gICAgZ2V0UGxhY2VkU2hpcHMsXG4gICAgZ2V0UmVjZWl2ZWRNaXNzZWRTaG90cyxcbiAgICBnZXRSZWNlaXZlZEhpdFNob3RzLFxuICAgIGdldFNlbnRNaXNzZWRTaG90cyxcbiAgICBnZXRTZW50SGl0U2hvdHMsXG4gICAgaXNBbGxTaGlwc1N1bmssXG4gICAgcGxhY2VTaGlwLFxuICAgIHJlY2VpdmVBdHRhY2ssXG4gICAgYWRkU2VudE1pc3NlZFNob3QsXG4gICAgYWRkU2VudEhpdFNob3QsXG4gIH07XG59O1xuXG5leHBvcnQgeyBHYW1lYm9hcmQgfTtcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuL3BsYXllclwiO1xuaW1wb3J0IHsgRE9NQ29udHJvbGxlciB9IGZyb20gXCIuL0RPTV9jb250cm9sbGVyXCI7XG5cbmNvbnN0IEdhbWVMb29wID0gKCgpID0+IHtcbiAgY29uc3QgcGxheWVycyA9IFtdO1xuICBsZXQgaW5Qcm9ncmVzcyA9IHRydWU7XG4gIGxldCB3aW5uZXI7XG4gIGxldCBtaWRBdHRhY2sgPSBmYWxzZTtcbiAgY29uc3QgZ2V0UGxheWVycyA9ICgpID0+IHBsYXllcnM7XG4gIGNvbnN0IGlzSW5Qcm9ncmVzcyA9ICgpID0+IGluUHJvZ3Jlc3M7XG4gIGNvbnN0IGdldFdpbm5lciA9ICgpID0+IHdpbm5lcjtcbiAgY29uc3QgaXNNaWRBdHRhY2sgPSAoKSA9PiBtaWRBdHRhY2s7XG4gIGNvbnN0IHRvZ2dsZU1pZEF0dGFjayA9IChzdGF0ZSkgPT4ge1xuICAgIHN0YXRlID8gKG1pZEF0dGFjayA9IHRydWUpIDogKG1pZEF0dGFjayA9IGZhbHNlKTtcbiAgfTtcbiAgY29uc3QgY3JlYXRlR2FtZSA9ICgpID0+IHtcbiAgICBjb25zdCBodW1hblBsYXllciA9IFBsYXllcihcImh1bWFuXCIpO1xuICAgIHBsYXllcnMucHVzaChodW1hblBsYXllcik7XG4gICAgY29uc3QgY29tcHV0ZXJQbGF5ZXIgPSBQbGF5ZXIoXCJjb21wdXRlclwiKTtcbiAgICBwbGF5ZXJzLnB1c2goY29tcHV0ZXJQbGF5ZXIpO1xuICAgIGh1bWFuUGxheWVyLnNldE9wcG9zaW5nUGxheWVyKGNvbXB1dGVyUGxheWVyKTtcbiAgICBjb21wdXRlclBsYXllci5zZXRPcHBvc2luZ1BsYXllcihodW1hblBsYXllcik7XG4gICAgY29tcHV0ZXJQbGF5ZXIuaW5pdGlhbGl6ZUNvbXB1dGVyR2FtZWJvYXJkKCk7XG4gIH07XG4gIGNvbnN0IGVuZEdhbWUgPSAobG9zZXJQbGF5ZXIpID0+IHtcbiAgICBjb25zdCB3aW5uZXJQbGF5ZXIgPSBsb3NlclBsYXllci5nZXRPcHBvc2luZ1BsYXllcigpO1xuICAgIGluUHJvZ3Jlc3MgPSBmYWxzZTtcbiAgICB3aW5uZXIgPSB3aW5uZXJQbGF5ZXI7XG4gICAgRE9NQ29udHJvbGxlci50b2dnbGVBYmlsaXR5VG9BdHRhY2soXCJkaXNhYmxlXCIpO1xuICAgIERPTUNvbnRyb2xsZXIuZGlzcGxheVdpbm5lcih3aW5uZXIpO1xuICB9O1xuICBjb25zdCByZXNldEdhbWVMb29wU3RhdGUgPSAoKSA9PiB7XG4gICAgcGxheWVycy5sZW5ndGggPSAwO1xuICAgIGluUHJvZ3Jlc3MgPSB0cnVlO1xuICAgIHdpbm5lciA9IHVuZGVmaW5lZDtcbiAgfTtcbiAgY29uc3QgcmVzZXRHYW1lID0gKCkgPT4ge1xuICAgIHJlc2V0R2FtZUxvb3BTdGF0ZSgpO1xuICAgIERPTUNvbnRyb2xsZXIucmVzZXRET00oKTtcbiAgICBjcmVhdGVHYW1lKCk7XG4gICAgRE9NQ29udHJvbGxlci5pbml0aWFsaXplQm9hcmRET00oKTtcbiAgfTtcbiAgcmV0dXJuIHtcbiAgICBnZXRQbGF5ZXJzLFxuICAgIGlzSW5Qcm9ncmVzcyxcbiAgICBnZXRXaW5uZXIsXG4gICAgaXNNaWRBdHRhY2ssXG4gICAgdG9nZ2xlTWlkQXR0YWNrLFxuICAgIGNyZWF0ZUdhbWUsXG4gICAgZW5kR2FtZSxcbiAgICByZXNldEdhbWUsXG4gICAgcmVzZXRHYW1lTG9vcFN0YXRlLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IHsgR2FtZUxvb3AgfTtcbiIsImltcG9ydCB7IERPTUNvbnRyb2xsZXIgfSBmcm9tIFwiLi9ET01fY29udHJvbGxlclwiO1xuaW1wb3J0IHsgR2FtZUxvb3AgfSBmcm9tIFwiLi9nYW1lbG9vcFwiO1xuXG5jb25zdCBFdmVudExpc3RlbmVyQ29udHJvbGxlciA9ICgoKSA9PiB7XG4gIGNvbnN0IHJvdGF0ZVNoaXBJbWFnZUxpc3RlbmVycyA9ICgpID0+IHtcbiAgICBjb25zdCBzaGlwUGxhY2VtZW50RWxlbWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLnNoaXAtcGxhY2VtZW50XCIpO1xuICAgIHNoaXBQbGFjZW1lbnRFbGVtZW50cy5mb3JFYWNoKChncm91cE9mRWxlbWVudHMpID0+IHtcbiAgICAgIGNvbnN0IGltYWdlRWxlbWVudCA9IGdyb3VwT2ZFbGVtZW50cy5xdWVyeVNlbGVjdG9yKFwiaW1nXCIpO1xuICAgICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IGdyb3VwT2ZFbGVtZW50cy5xdWVyeVNlbGVjdG9yKFwiYnV0dG9uXCIpO1xuICAgICAgYnV0dG9uRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBET01Db250cm9sbGVyLnJvdGF0ZVNoaXBJbWFnZShpbWFnZUVsZW1lbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGFkZFNoaXBQbGFjZW1lbnREcmFnID0gKCkgPT4ge1xuICAgIGNvbnN0IHNoaXBJbWFnZXMgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2hpcC1waWVjZVwiKSk7XG4gICAgc2hpcEltYWdlcy5mb3JFYWNoKChzaGlwKSA9PiB7XG4gICAgICBzaGlwLmFkZEV2ZW50TGlzdGVuZXIoXCJkcmFnc3RhcnRcIiwgKGV2ZW50KSA9PiB7XG4gICAgICAgIERPTUNvbnRyb2xsZXIuZ2V0RHJhZ2dlZEltYWdlKGV2ZW50KTtcbiAgICAgICAgRE9NQ29udHJvbGxlci5yb3RhdGVEcmFnZ2VkSW1hZ2UoZXZlbnQpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH07XG4gIGNvbnN0IGFkZFBsYXlBZ2Fpbkxpc3RlbmVyID0gKCkgPT4ge1xuICAgIGNvbnN0IHBsYXlBZ2FpbkJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucGxheS1hZ2FpblwiKTtcbiAgICBwbGF5QWdhaW5CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIEdhbWVMb29wLnJlc2V0R2FtZSgpO1xuICAgIH0pO1xuICB9O1xuICByZXR1cm4ge1xuICAgIHJvdGF0ZVNoaXBJbWFnZUxpc3RlbmVycyxcbiAgICBhZGRTaGlwUGxhY2VtZW50RHJhZyxcbiAgICBhZGRQbGF5QWdhaW5MaXN0ZW5lcixcbiAgfTtcbn0pKCk7XG5cbmV4cG9ydCB7IEV2ZW50TGlzdGVuZXJDb250cm9sbGVyIH07XG4iLCJpbXBvcnQgeyBHYW1lTG9vcCB9IGZyb20gXCIuL2dhbWVsb29wXCI7XG5pbXBvcnQgeyBET01Db250cm9sbGVyIH0gZnJvbSBcIi4vRE9NX2NvbnRyb2xsZXJcIjtcbmltcG9ydCB7IEV2ZW50TGlzdGVuZXJDb250cm9sbGVyIH0gZnJvbSBcIi4vZXZlbnRfbGlzdGVuZXJfY29udHJvbGxlclwiO1xuXG5HYW1lTG9vcC5jcmVhdGVHYW1lKCk7XG5cbkRPTUNvbnRyb2xsZXIuaW5pdGlhbGl6ZUJvYXJkRE9NKCk7XG5cbkV2ZW50TGlzdGVuZXJDb250cm9sbGVyLnJvdGF0ZVNoaXBJbWFnZUxpc3RlbmVycygpO1xuXG5FdmVudExpc3RlbmVyQ29udHJvbGxlci5hZGRTaGlwUGxhY2VtZW50RHJhZygpO1xuXG5FdmVudExpc3RlbmVyQ29udHJvbGxlci5hZGRQbGF5QWdhaW5MaXN0ZW5lcigpO1xuIl0sIm5hbWVzIjpbIkRPTUNvbnRyb2xsZXIiLCJjcmVhdGVCb2FyZENlbGxzIiwiZ2FtZWJvYXJkRE9NIiwiY29sdW1uTGFiZWxzIiwicm93TGFiZWxzIiwiaHVtYW5QbGF5ZXJPYmplY3QiLCJHYW1lTG9vcCIsImdldFBsYXllcnMiLCJpIiwiaiIsImludmlzaWJsZVBsYWNlaG9sZGVyRWxlbWVudCIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTGlzdCIsImFkZCIsInN0eWxlIiwidmlzaWJpbGl0eSIsImFwcGVuZENoaWxkIiwiY29sdW1uTGFiZWxFbGVtZW50IiwidGV4dENvbnRlbnQiLCJyb3dMYWJlbEVsZW1lbnQiLCJBcnJheSIsImZyb20iLCJpbmNsdWRlcyIsInBsYXllckNlbGxFbGVtZW50Iiwic2V0QXR0cmlidXRlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImV2ZW50IiwiZHJhZ092ZXIiLCJpbnNlcnREcmFnZ2VkSW1hZ2UiLCJnZXRHYW1lYm9hcmQiLCJnZXRQbGFjZWRTaGlwcyIsImxlbmd0aCIsInRvZ2dsZUFiaWxpdHlUb0F0dGFjayIsImNvbXB1dGVyQ2VsbEVsZW1lbnQiLCJkaXNhYmxlZCIsImlzTWlkQXR0YWNrIiwiY2VsbFJvdyIsIk51bWJlciIsImRhdGFzZXQiLCJyb3ciLCJjZWxsQ29sdW1uIiwiY29sdW1uIiwic2VuZEF0dGFjayIsImFjdGlvbiIsImNvbXB1dGVyR2FtZWJvYXJkRWxlbWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjZWxsRWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImNlbGxFbGVtZW50IiwicHJldmVudERlZmF1bHQiLCJjcmVhdGVFcnJvck1lc3NhZ2UiLCJlcnJvck1lc3NhZ2UiLCJib2R5Iiwic2V0VGltZW91dCIsInJlbW92ZUNoaWxkIiwidGFyZ2V0Q2VsbCIsInRhcmdldCIsImRhdGFTdHJpbmciLCJkYXRhVHJhbnNmZXIiLCJnZXREYXRhIiwiZGF0YU9iamVjdCIsIkpTT04iLCJwYXJzZSIsImNlbGxDb29yZGluYXRlcyIsInNoaXBMZW5ndGgiLCJob3Jpem9udGFsIiwiY2hlY2tJZlZhbGlkRW1wdHlDb29yZGluYXRlcyIsInZlcnRpY2FsIiwiaXNWYWxpZEdhbWVib2FyZENlbGwiLCJzaGlwQ29vcmRpbmF0ZXMiLCJ0YXJnZXRDZWxsUm93IiwidGFyZ2V0Q2VsbENvbHVtbiIsImNvb3JkaW5hdGVzQXJyYXkiLCJyZW1haW5pbmdDZWxsIiwicHVzaCIsImFkZFNoaXBUb0RPTSIsImFkZFNoaXBUb0dhbWVib2FyZCIsIklEIiwiZWxlbWVudElEIiwiaW1hZ2VFbGVtZW50IiwiYnV0dG9uRWxlbWVudCIsInBhcmVudE5vZGUiLCJkaXNhYmxlSW1hZ2VCdXR0b25JbnRlcmFjdGlvbnMiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiaW5pdGlhbGl6ZUJvYXJkRE9NIiwiaHVtYW5QbGF5ZXJHYW1lYm9hcmRET00iLCJjb21wdXRlckdhbWVib2FyZERPTSIsInJvdGF0ZVNoaXBJbWFnZSIsImltYWdlIiwiaW1hZ2VDbGFzc2VzIiwicmVtb3ZlIiwicm90YXRlRHJhZ2dlZEltYWdlIiwiY2xvbmVkSW1hZ2VFbGVtZW50IiwiY2xvbmVOb2RlIiwidGVtcERpdiIsImNsb25lZEltYWdlRWxlbWVudENsYXNzZXMiLCJyb3RhdGVQZXJMZW5ndGgiLCJzZXREcmFnSW1hZ2UiLCJnZXREcmFnZ2VkSW1hZ2UiLCJzcmMiLCJnZXRBdHRyaWJ1dGUiLCJzdHJpbmdpZnkiLCJzZXREYXRhIiwiYWRkQXR0YWNrUmVzdWx0RE9NIiwicGxheWVyVHlwZSIsImF0dGFja1Jlc3VsdHMiLCJjb29yZGluYXRlcyIsImF0dGFja1Jlc3VsdHNFbGVtZW50IiwiZGlzcGxheVdpbm5lciIsIndpbm5pbmdQbGF5ZXIiLCJpc0NvbXB1dGVyIiwicmVzZXRET00iLCJpbm5lckhUTUwiLCJidXR0b24iLCJnYW1lUmVzdWx0c0VsZW1lbnQiLCJyZXNldEdhbWVSZXN1bHRzIiwiUGxheWVyIiwiY29tcHV0ZXJQbGF5ZXIiLCJwbGF5ZXJHYW1lYm9hcmQiLCJib2FyZCIsInVuZGVmaW5lZCIsImNyZWF0ZUJvYXJkIiwicGxhY2VkU2hpcHMiLCJyZWNlaXZlZE1pc3NlZFNob3RzIiwicmVjZWl2ZWRIaXRTaG90cyIsInNlbnRNaXNzZWRTaG90cyIsInNlbnRIaXRTaG90cyIsImFsbFNoaXBzU3VuayIsImdldENvb3JkaW5hdGVzIiwiZ2V0UmVjZWl2ZWRNaXNzZWRTaG90cyIsImdldFJlY2VpdmVkSGl0U2hvdHMiLCJnZXRTZW50TWlzc2VkU2hvdHMiLCJnZXRTZW50SGl0U2hvdHMiLCJpc0FsbFNoaXBzU3VuayIsInBsYWNlU2hpcCIsInNoaXAiLCJjb29yZGluYXRlc0xpc3QiLCJyZWNlaXZlQXR0YWNrIiwiZW50aXR5QXRDb29yZGluYXRlcyIsImhpdCIsImV2ZXJ5IiwiaXNTdW5rIiwiYWRkU2VudE1pc3NlZFNob3QiLCJhZGRTZW50SGl0U2hvdCIsIkdhbWVib2FyZCIsIm9wcG9zaW5nUGxheWVyIiwiZ2l2ZW5MZW5ndGgiLCJoaXRzIiwic3VuayIsImdldFNoaXBMZW5ndGgiLCJnZXRTaGlwSGl0cyIsIlNoaXAiLCJjaGVja0lmUHJldmlvdXNseUF0dGFja2VkIiwiaXNJblByb2dyZXNzIiwib3Bwb3NpbmdQbGF5ZXJHYW1lYm9hcmQiLCJlbmRHYW1lIiwidG9nZ2xlTWlkQXR0YWNrIiwic2VuZENvbXB1dGVyQXR0YWNrIiwiZ2VuZXJhdGVDb21wdXRlclNoaXBDb29yZGluYXRlcyIsImxpc3RPZkNvb3JkaW5hdGVzIiwic3RhcnRpbmdDb29yZGluYXRlcyIsImdlbmVyYXRlU3RhcnRpbmdDb29yZGluYXRlcyIsIm5vblN0YXJ0aW5nQ29vcmRpbmF0ZXMiLCJnZW5lcmF0ZU5vblN0YXJ0aW5nQ29vcmRpbmF0ZXMiLCJjb25jYXQiLCJnZW5lcmF0ZVJhbmRvbUNvb3JkaW5hdGUiLCJwb3NzaWJsZUNvb3JkaW5hdGVzIiwidXBDb29yZGluYXRlcyIsInJpZ2h0Q29vcmRpbmF0ZXMiLCJkb3duQ29vcmRpbmF0ZXMiLCJsZWZ0Q29vcmRpbmF0ZXMiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJhdHRhY2tDb29yZGluYXRlcyIsInByZXZpb3VzbHlBdHRhY2tlZCIsInNvbWUiLCJzaG90IiwiZGlyZWN0aW9uIiwiZ2V0T3Bwb3NpbmdQbGF5ZXIiLCJzZXRPcHBvc2luZ1BsYXllciIsInBsYXllciIsImluaXRpYWxpemVDb21wdXRlckdhbWVib2FyZCIsImxlbmd0aHNPZlNoaXBzIiwiZ2VuZXJhdGVBdHRhY2tDb29yZGluYXRlcyIsInBsYXllcnMiLCJ3aW5uZXIiLCJpblByb2dyZXNzIiwibWlkQXR0YWNrIiwiY3JlYXRlR2FtZSIsImh1bWFuUGxheWVyIiwicmVzZXRHYW1lTG9vcFN0YXRlIiwiZ2V0V2lubmVyIiwic3RhdGUiLCJsb3NlclBsYXllciIsIndpbm5lclBsYXllciIsInJlc2V0R2FtZSIsIkV2ZW50TGlzdGVuZXJDb250cm9sbGVyIiwiZ3JvdXBPZkVsZW1lbnRzIl0sInNvdXJjZVJvb3QiOiIifQ==